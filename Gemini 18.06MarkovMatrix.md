---
sr-due: 2025-05-18
sr-interval: 3
sr-ease: 250
---

#review 

>A property (kind of definition): The elements of a column must be added up to 1. Because probablity should be summed up to 1.
>Stable vector and stable state. An eigenvector and the trend of eigenvalues when the iteration times has gone near $\infty$.
>*A significant property*. There must be an eigenvalue $\lambda=1$. 
### 引入与动机 (Hook & Motivation)

想象一下天气。如果今天是晴天，明天是晴天的概率是 90%，是雨天的概率是 10%。如果今天是雨天，明天是晴天的概率是 50%，是雨天的概率也是 50%。

这是一个简单的**随机过程**，它随时间一步一步变化，而且“明天”的天气只取决于“今天”的天气，与“昨天”甚至更早的天气无关。这种具有“无记忆性”的随机过程，我们就称之为**马尔可夫链 (Markov Chain)**。

我们可能会问一些问题：
1.  如果今天已知是晴天，那么后天是雨天的概率是多少？
2.  经过很长很长时间后（比如一个月后），是晴天的概率和是雨天的概率会稳定在一个值吗？这个稳定的概率分布是什么？

传统的概率方法可能需要画树状图，一步一步计算，非常繁琐。但线性代数提供了一个优雅而强大的工具来解决这类问题——那就是**马尔可夫矩阵**。

马尔可夫矩阵就是用来描述这种**状态之间转移概率**的。学习它，能让我们用矩阵和向量的语言来建模和分析随时间演变的随机系统，特别是理解它们的**长期行为（稳态）**。这在自然科学、工程、经济、计算机科学（比如著名的 PageRank 算法）等领域都有广泛应用。

### 必要知识回顾 (Prerequisite Review)

为了理解马尔可夫矩阵，我们需要回顾一些前置概念：

1.  **向量作为状态表示：** 我们可以用一个向量来表示系统在某一时刻的状态。例如，在一个只有两个状态（晴天、雨天）的系统中，我们可以用向量 $\mathbf{x} = \begin{pmatrix} p_{晴} \\ p_{雨} \end{pmatrix}$ 来表示某一时刻是晴天的概率 $p_{晴}$ 和是雨天的概率 $p_{雨}$。注意，$p_{晴} \ge 0, p_{雨} \ge 0$，并且 $p_{晴} + p_{雨} = 1$ (总概率为 1)。这种向量称为**概率分布向量**或**状态向量**。
2.  **矩阵乘法 $A\mathbf{x}$ 作为状态转移：** 如果我们有一个矩阵 $T$ 和一个状态向量 $\mathbf{x}_k$，计算 $\mathbf{x}_{k+1} = T \mathbf{x}_k$ 可以用来表示系统从第 $k$ 个时刻的状态 $\mathbf{x}_k$ 转移到第 $k+1$ 个时刻的状态 $\mathbf{x}_{k+1}$。矩阵 $T$ 封装了状态转移的规则。
3.  **特征值和特征向量：** 回顾我们上节课讲的：对于矩阵 $A$，如果 $A\mathbf{v} = \lambda \mathbf{v}$，则 $\mathbf{v}$ 是特征向量，$\lambda$ 是特征值。特征向量表示在矩阵变换下方向不变的向量，特征值是该方向上的伸缩因子。

### 直观解释与感性认识 (Intuitive Explanation)

我们回到天气例子。设状态 1 是晴天 (S)，状态 2 是雨天 (R)。

我们用一个矩阵来表示从“今天”到“明天”的概率转移：
$$ T = \begin{pmatrix} p_{S \to S} & p_{R \to S} \\ p_{S \to R} & p_{R \to R} \end{pmatrix} $$
这里的 $p_{A \to B}$ 表示从状态 A 转移到状态 B 的概率。
根据我们的例子：
*   从晴天 (S) 转移到晴天 (S) 的概率是 0.9 ($p_{S \to S} = 0.9$)
*   从晴天 (S) 转移到雨天 (R) 的概率是 0.1 ($p_{S \to R} = 0.1$)
*   从雨天 (R) 转移到晴天 (S) 的概率是 0.5 ($p_{R \to S} = 0.5$)
*   从雨天 (R) 转移到雨天 (R) 的概率是 0.5 ($p_{R \to R} = 0.5$)

把这些概率填入矩阵 $T$:
$$ T = \begin{pmatrix} 0.9 & 0.5 \\ 0.1 & 0.5 \end{pmatrix} $$

注意这个矩阵的**列**！
*   第一列 $\begin{pmatrix} 0.9 \\ 0.1 \end{pmatrix}$ 表示如果**今天处于状态 1 (晴天)**，那么明天转移到各个状态（晴天、雨天）的概率分布。这些概率加起来必须是 1 ($0.9 + 0.1 = 1$)，因为如果今天是晴天，明天必然要么晴天要么雨天。
*   第二列 $\begin{pmatrix} 0.5 \\ 0.5 \end{pmatrix}$ 表示如果**今天处于状态 2 (雨天)**，那么明天转移到各个状态的概率分布。这些概率加起来也必须是 1 ($0.5 + 0.5 = 1$)。

这就是马尔可夫矩阵的**核心直觉**：**每一列代表了从一个特定状态出发，转移到所有可能状态的概率分布，因此每一列的元素之和必须是 1。** 矩阵的元素 $T_{ij}$ 表示从状态 $j$ 转移到状态 $i$ 的概率。

现在，假设今天的状态向量是 $\mathbf{x}_0 = \begin{pmatrix} p_{S,0} \\ p_{R,0} \end{pmatrix}$，比如今天一定是晴天，那么 $\mathbf{x}_0 = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$。

明天的状态向量 $\mathbf{x}_1$ 怎么算？
明天的晴天概率 ($p_{S,1}$) 等于：(今天晴天 -> 明天晴天 的概率) $\times$ (今天晴天的概率) + (今天雨天 -> 明天晴天 的概率) $\times$ (今天雨天的概率)
$p_{S,1} = p_{S \to S} \cdot p_{S,0} + p_{R \to S} \cdot p_{R,0}$

明天的雨天概率 ($p_{R,1}$) 等于：(今天晴天 -> 明天雨天 的概率) $\times$ (今天晴天的概率) + (今天雨天 -> 明天雨天 的概率) $\times$ (今天雨天的概率)
$p_{R,1} = p_{S \to R} \cdot p_{S,0} + p_{R \to R} \cdot p_{R,0}$

这正好是矩阵乘法的形式！
$$ \mathbf{x}_1 = \begin{pmatrix} p_{S,1} \\ p_{R,1} \end{pmatrix} = \begin{pmatrix} p_{S \to S} & p_{R \to S} \\ p_{S \to R} & p_{R \to R} \end{pmatrix} \begin{pmatrix} p_{S,0} \\ p_{R,0} \end{pmatrix} = T \mathbf{x}_0 $$
太棒了！用矩阵乘法就可以一步计算出下一时刻的状态分布。

那么后天的状态 $\mathbf{x}_2$ 呢？ $\mathbf{x}_2 = T \mathbf{x}_1 = T (T \mathbf{x}_0) = T^2 \mathbf{x}_0$。
$k$ 天后的状态 $\mathbf{x}_k$ 就是 $\mathbf{x}_k = T^k \mathbf{x}_0$。

这就是马尔可夫矩阵的第二个核心直觉：**它代表了系统的一步转移；重复应用它（计算 $T^k$）就能预测系统的未来状态。**

现在考虑长期行为：经过非常非常多步之后 ($k \to \infty$)，状态分布 $\mathbf{x}_k$ 会趋向于一个**稳态 (steady state)** $\mathbf{x}_{\infty}$ 吗？如果会，这个稳态有什么性质？
如果系统达到了稳态 $\mathbf{x}_{\infty}$，意味着从这一步到下一步，状态分布不再改变。也就是 $\mathbf{x}_{\infty} = T \mathbf{x}_{\infty}$。

看看这个等式：$\mathbf{x}_{\infty} = T \mathbf{x}_{\infty}$。这不就是我们刚刚回顾的特征向量的定义 $A\mathbf{v} = \lambda \mathbf{v}$ 的形式吗？
只不过这里的矩阵是 $T$，特征向量是 $\mathbf{x}_{\infty}$，而特征值 $\lambda$ 是 **1**！

所以，马尔可夫链的稳态，**就是其转移矩阵 $T$ 对应于特征值 $\lambda=1$ 的那个特征向量**（再归一化使其元素和为 1，因为它是概率分布向量）。

这真是太漂亮了！原本看起来复杂的概率转移问题，通过线性代数，特别是特征值和特征向量，找到了其长期行为的内在规律。

### 逐步形式化与精确定义 (Gradual Formalization)

现在我们给出严格的定义：

一个 $n \times n$ 的矩阵 $T$ 称为**马尔可夫矩阵 (Markov Matrix)** 或**随机矩阵 (Stochastic Matrix)**，如果它满足以下两个条件：
1.  所有元素都是非负的：$T_{ij} \ge 0$ 对所有的 $i, j$ 都成立。
2.  每一列的<font color="#ffff00">元素之和等于 1</font>：$\sum_{i=1}^n T_{ij} = 1$ 对所有的 $j=1, 2, \dots, n$ 都成立。

一个 $n \times 1$ 的向量 $\mathbf{x}$ 称为一个**概率分布向量**或**状态向量**，如果它满足：
1.  所有元素都是非负的：$x_i \ge 0$ 对所有的 $i$ 都成立。
2.  所有元素的和等于 1：$\sum_{i=1}^n x_i = 1$。

在一个有 $n$ 个状态的马尔可夫链中，如果 $\mathbf{x}_k$ 是系统在第 $k$ 步的状态向量，$T$ 是转移矩阵，那么系统在第 $k+1$ 步的状态向量为：
$$ \mathbf{x}_{k+1} = T \mathbf{x}_k $$

如果存在一个概率分布向量 $\mathbf{x}^*$ 使得 $T \mathbf{x}^* = \mathbf{x}^*$，则 $\mathbf{x}^*$ 称为系统的**稳态向量 (Steady State Vector)** 或**平稳分布 (Stationary Distribution)**。

### 核心原理与推导过程 (Core Principles & Derivation Walkthrough)

马尔可夫矩阵有两个最核心、最美丽的性质：

**原理 1：马尔可夫矩阵总是有一个特征值等于 1 ($\lambda=1$)。**

**为什么是这样？（推导思路）**
我们知道马尔可夫矩阵 $T$ 的每一列元素之和等于 1。这个信息怎么用特征值的定义 $T\mathbf{v} = \lambda \mathbf{v}$ 联系起来呢？
直接看 $T\mathbf{v} = \lambda \mathbf{v}$ 可能不太直观。我们换个角度。考虑矩阵的**转置** $T^T$。
如果 $T$ 的每一列之和是 1，那么 $T^T$ 的**每一行**之和就是 1。
比如我们之前的天气矩阵 $T = \begin{pmatrix} 0.9 & 0.5 \\ 0.1 & 0.5 \end{pmatrix}$。
它的转置是 $T^T = \begin{pmatrix} 0.9 & 0.1 \\ 0.5 & 0.5 \end{pmatrix}$。
你看， $0.9 + 0.1 = 1$ (第一行之和)，$0.5 + 0.5 = 1$ (第二行之和)。

现在，考虑一个特殊的向量：所有元素都是 1 的向量，我们记为 $\mathbf{1} = \begin{pmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{pmatrix}$。
用 $T^T$ 乘以 $\mathbf{1}$:
$(T^T \mathbf{1})_i$ 是 $T^T$ 的第 $i$ 行与向量 $\mathbf{1}$ 相乘。
$(T^T \mathbf{1})_i = \sum_{j=1}^n (T^T)_{ij} \cdot (\mathbf{1})_j = \sum_{j=1}^n T_{ji} \cdot 1 = \sum_{j=1}^n T_{ji}$。
这个和 $\sum_{j=1}^n T_{ji}$ 正好是矩阵 $T$ 的第 $i$ **列**的元素之和！而根据马尔可夫矩阵的定义，这个和等于 1。
所以，$T^T \mathbf{1}$ 的第 $i$ 个分量就是 1。这意味着：
$T^T \mathbf{1} = \begin{pmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{pmatrix} = 1 \cdot \begin{pmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{pmatrix} = 1 \cdot \mathbf{1}$。

这个等式 $T^T \mathbf{1} = 1 \cdot \mathbf{1}$ 清晰地表明：向量 $\mathbf{1}$ 是矩阵 $T^T$ 的一个特征向量，而对应的特征值是 $\lambda=1$。

**核心定理：** 一个矩阵和它的转置有相同的特征值。
(思考：为什么？ 特征值是通过求解 $\det(A - \lambda I) = 0$ 得到的。而我们知道 $\det(A - \lambda I) = \det((A - \lambda I)^T) = \det(A^T - (\lambda I)^T) = \det(A^T - \lambda I)$。因为 $\det(A - \lambda I) = \det(A^T - \lambda I)$，所以它们的特征方程相同，特征值也就相同。)

既然 $T^T$ 有特征值 $\lambda=1$，那么 $T$ 也必然有特征值 $\lambda=1$。

这个推导虽然巧妙地利用了转置，但思路是直接的：从“列和为 1”这个定义出发，去寻找一个向量，当 $T^T$ 作用于它时，结果是它自身的倍数。而那个“所有元素都是 1”的向量 $\mathbf{1}$ 恰好做到了这一点，并且那个倍数就是 1。

**原理 2：对应于特征值 $\lambda=1$ 的特征向量（如果经过归一化），就是系统的稳态向量。**

**为什么是这样？（推导思路）**
我们回顾稳态的定义：如果系统达到稳态 $\mathbf{x}^*$，那么一步转移不会改变状态分布。用公式表示就是 $\mathbf{x}^* = T \mathbf{x}^*$。

现在，把这个等式和特征向量的定义 $T\mathbf{v} = \lambda \mathbf{v}$ 进行对比。
$T \mathbf{x}^* = \mathbf{x}^*$ 可以写成 $T \mathbf{x}^* = 1 \cdot \mathbf{x}^*$。

这**完全符合**特征向量的定义：$\mathbf{x}^*$ 是矩阵 $T$ 的一个特征向量，对应的特征值是 $\lambda = 1$。

所以，要找到马尔可夫链的稳态分布 $\mathbf{x}^*$，我们只需要：
1.  计算矩阵 $T$ 的特征值。我们已经知道一定会有 $\lambda=1$。
2.  找到对应于 $\lambda=1$ 的特征向量 $\mathbf{v}$。这需要解线性方程组 $(T - 1 \cdot I) \mathbf{v} = \mathbf{0}$，即 $(T - I) \mathbf{v} = \mathbf{0}$。
3.  求出的特征向量 $\mathbf{v}$ 通常不是概率分布向量（它的元素和不一定为 1）。因为它代表的是一个“方向”，这个方向上的所有向量都是特征向量。我们需要在这个“方向”上找到那个特殊的向量，它的元素都是非负的并且加起来等于 1。如果 $\mathbf{v}$ 的元素都是非负的（马尔可夫链的稳态向量元素必须是非负概率），我们将 $\mathbf{v}$ 的每个元素除以所有元素的总和 $\sum v_i$ 进行归一化。得到的向量 $\mathbf{x}^* = \frac{1}{\sum v_i} \mathbf{v}$ 就是稳态向量。

（这里隐含了一个条件：对于“正常”的马尔可夫链（例如，对应的图是连通的，称为不可约），对应于 $\lambda=1$ 的特征子空间是一维的，这意味着只有一个线性无关的特征向量（除了零向量）。这样得到的稳态就是唯一的。而且，对于满足一定条件的马尔可夫矩阵（如所有元素都是正数，或者对应的图是不可约且非周期的），除了 $\lambda=1$ 之外，所有其他特征值的绝对值都小于 1，即 $|\lambda_i| < 1$ (对于 $i \ne 1$)。这保证了当 $k \to \infty$ 时，$T^k \mathbf{x}_0$ 会收敛到稳态，因为其他特征值对应的分量在 $T^k$ 中会衰减到零——回想 $A^k = P\Lambda^k P^{-1}$ 中 $\Lambda^k$ 对角线上 $|\lambda_i|^k$ 的行为）。

### 示例与应用 (Examples & Application)

我们回到天气例子： $T = \begin{pmatrix} 0.9 & 0.5 \\ 0.1 & 0.5 \end{pmatrix}$。

我们要找稳态 $\mathbf{x}^* = \begin{pmatrix} p_S \\ p_R \end{pmatrix}$，使得 $T \mathbf{x}^* = \mathbf{x}^*$，且 $p_S + p_R = 1$, $p_S, p_R \ge 0$。

>这就是解 $(T - I) \mathbf{x}^* = \mathbf{0}$:
>
>$T - I = \begin{pmatrix} 0.9 - 1 & 0.5 \\ 0.1 & 0.5 - 1 \end{pmatrix} = \begin{pmatrix} -0.1 & 0.5 \\ 0.1 & -0.5 \end{pmatrix}$

解方程组 $\begin{pmatrix} -0.1 & 0.5 \\ 0.1 & -0.5 \end{pmatrix} \begin{pmatrix} p_S \\ p_R \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}$。
两个方程都是 $-0.1 p_S + 0.5 p_R = 0$，即 $0.1 p_S = 0.5 p_R$，也就是 $p_S = 5 p_R$。

特征向量的方向满足 $p_S = 5 p_R$。一个可能的特征向量是 $\begin{pmatrix} 5 \\ 1 \end{pmatrix}$。
这个向量的元素和是 $5+1=6$。为了把它变成概率分布向量，我们需要归一化，让元素和为 1。
$\mathbf{x}^* = \frac{1}{6} \begin{pmatrix} 5 \\ 1 \end{pmatrix} = \begin{pmatrix} 5/6 \\ 1/6 \end{pmatrix}$。

所以，经过很长时间后，有 $5/6$ 的概率是晴天，有 $1/6$ 的概率是雨天。*这就是这个天气系统的稳态分布*。无论你从晴天开始 ($\begin{pmatrix} 1 \\ 0 \end{pmatrix}$)，雨天开始 ($\begin{pmatrix} 0 \\ 1 \end{pmatrix}$)，还是任何其他概率分布开始，天气分布都会最终趋向于 $\begin{pmatrix} 5/6 \\ 1/6 \end{pmatrix}$。

**PageRank 应用简介：**
Google 的 PageRank 算法是马尔可夫链的一个著名应用。想象互联网是一个巨大的有向图，网页是节点，链接是边。构建一个巨大的转移矩阵 $T$，其中 $T_{ij}$ 表示从网页 $j$ 随机跳转到网页 $i$ 的概率（这个概率考虑了网页的出链数和用户随机跳转到任意网页的可能性）。用户随机浏览网页的行为就可以建模为一个马尔可夫链。PageRank 就是这个转移矩阵对应的特征值 $\lambda=1$ 的特征向量！向量的每个分量代表对应网页的“重要性”或“排名”。具有较高 PageRank 值的网页更可能被随机漫游的用户访问到。这个稳态向量通过迭代计算 $T^k \mathbf{x}_0$（从一个初始排名分布开始）来近似求解，因为对于巨大的网络，直接解 $(T-I)\mathbf{x}=\mathbf{0}$ 可能计算量太大。

### 知识点总结与要点提炼 (Summary & Key Takeaways)

*   **马尔可夫矩阵 $T$：** 方阵，元素非负，$T_{ij}$ 表示从状态 $j$ 转移到状态 $i$ 的概率。**核心性质：列和为 1**。
*   **状态向量 $\mathbf{x}$：** 向量，元素非负，元素和为 1，表示系统在某时刻的状态概率分布。
*   **状态转移：** $\mathbf{x}_{k+1} = T \mathbf{x}_k$。 $k$ 步转移是 $T^k \mathbf{x}_0$.
*   **稳态 $\mathbf{x}^*$：** 使状态分布不再改变的特殊状态向量，$T \mathbf{x}^* = \mathbf{x}^*$.
*   **马尔可夫矩阵的 Eigen-Properties：**
    *   **总是存在特征值 $\lambda=1$**。这是因为其转置 $T^T$ 作用于全 1 向量 $\mathbf{1}$ 时，$T^T \mathbf{1} = \mathbf{1}$，而 $T$ 和 $T^T$ 有相同的特征值。
    *   **稳态向量就是对应于 $\lambda=1$ 的特征向量**（经过归一化使其元素和为 1）。这是因为稳态的定义方程 $\mathbf{x}^* = T \mathbf{x}^*$ 正是特征向量方程 $T\mathbf{v} = 1 \cdot \mathbf{v}$ 的形式。
    *   对于某些类型的马尔可夫矩阵，所有其他特征值的绝对值都小于 1 ($|\lambda_i| < 1$ for $i \ne 1$)，这保证了系统会收敛到唯一的稳态。
*   **应用：** 建模和预测随时间变化的概率系统，如天气、人口流动、网页排名等。核心是通过特征值和特征向量来理解系统的长期行为。

### 学科思想与延伸思考 (Underlying Philosophy & Further Thinking)

马尔可夫矩阵和马尔可夫链是线性代数在概率和随机过程中的一个优美应用。它展示了：

1.  **抽象的力量：** 将具体的概率转移过程抽象成矩阵和向量的运算，使得我们可以用统一的数学工具来分析不同领域的系统。
2.  **结构决定行为：** 马尔可夫矩阵的结构（非负元素，列和为 1）直接决定了它必然拥有特征值 1，进而决定了系统可能存在稳态。矩阵的内在属性（特征值、特征向量）揭示了其所代表的系统的内在、长期行为。
3.  **动静结合：** 矩阵乘法 $T \mathbf{x}_k$ 描述了系统的动态转移（一步步变化），而特征向量 $\mathbf{x}^*$ ($\lambda=1$) 则描述了系统的静态平衡点（稳态）。线性代数提供了从动态过程分析其静态结果的框架。

**高观点导航：**

*   **Perron-Frobenius 定理：** 对于元素皆为正数的马尔可夫矩阵，Perron-Frobenius 定理更进一步保证：
    *   $\lambda=1$ 是它唯一的模（绝对值）最大的特征值。
    *   对应于 $\lambda=1$ 的特征向量可以取一个所有分量都是正数的向量，并且这个特征向量是唯一的（除了常数因子）。
    *   这解释了为什么“正常”的马尔可夫链会有唯一的、有实际意义（所有概率非负）的稳态，并且系统会收敛到这个稳态。
*   **广义特征值问题：** 虽然这里我们关注的是 $T\mathbf{x} = \lambda \mathbf{x}$，但在更广泛的线性代数应用中，特征值问题 $A\mathbf{v} = \lambda \mathbf{v}$ 无处不在，它们总是在寻找特定变换下的“本征”模式或“不变”方向及其对应的“尺度”变化。马尔可夫矩阵的 $\lambda=1$ 特征对就是这类问题的一个非常具有物理/概率意义的体现。

通过特征值和特征向量的视角，原本需要一步步计算概率转移的繁琐过程，变成了求解一个线性方程组 $(T-I)\mathbf{x} = \mathbf{0}$ 来找到稳态分布。这极大地提升了我们分析复杂系统的能力。

希望这次讲解让你对马尔可夫矩阵及其背后的思想有了深刻的理解！请告诉我你还有什么想深入了解的地方。