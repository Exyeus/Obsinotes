好的，同学你好！非常荣幸能为你讲解离散数学中格与布尔代数这一重要章节。这一部分的知识在计算机科学中有非常广泛的应用，比如数字电路设计、软件形式验证等等。虽然初看起来概念可能有点抽象，但它们都是从我们熟悉的集合、逻辑以及数的性质中抽象出来的。我会尽量从直观出发，带你一步步理解这些概念的本质和它们之间的联系，希望能帮助你构建起清晰的知识体系。

### 第十一章 格与布尔代数

#### 引入与动机：抽象的结构之美

我们在数学中遇到过许多带有运算的集合：整数集 Z 可以在加法和乘法下运算，实数集 R 也是如此。集合的幂集 $P(B)$ 可以在并集和交集下运算。甚至在线性代数中，向量空间可以在向量加法和标量乘法下运算。

我们注意到，这些不同的系统虽然具体操作不同，但它们的一些基本“行为”或“性质”却有着惊人的相似之处。比如：

*   集合的交集和并集都满足交换律和结合律。
*   整数的最大公约数和最小公倍数也满足交换律和结合律。
*   逻辑中的合取和析取也满足交换律和结合律。

这些结构背后的共同之处是什么呢？我们能否找到一个更一般的代数系统，能够概括这些不同的例子，并研究它们的共同性质？

格（Lattice）和布尔代数（Boolean Algebra）正是这样一类抽象的代数系统。它们都带有两个二元运算，但与环（Ring）等系统有着不同的侧重点。环侧重于加法构成群、乘法构成半群以及乘法对加法的分配律。而格，我们可以从偏序集（Poset）的角度去理解，它侧重于元素之间的“大小”关系以及基于这种关系定义的“交汇”和“联合”操作。布尔代数则是在格的基础上，增加了一些非常强大的性质（分配律和补元），这使得它能够完美地捕捉逻辑和集合运算的精髓。

理解格和布尔代数，不仅仅是学习一些定义和定理，更重要的是学习一种抽象和概括的思想，这对于你未来学习更高级的数学和计算机科学概念（比如类型理论、程序语义等）非常有益。

#### 必要知识回顾：偏序关系与上下界

在深入格的定义之前，我们先快速回顾几个前置概念：

*   **二元关系 (Binary Relation):** 在集合 $S$ 上的二元关系 $R$ 是 $S \times S$ 的一个子集。如果 $(a, b) \in R$，我们常记为 $a R b$。
*   **偏序关系 (Partial Order Relation):** 集合 $S$ 上的一个二元关系 $\preccurlyeq$ 称为偏序关系，如果它满足以下三个性质：
    *   **自反性 (Reflexive):** $\forall a \in S, a \preccurlyeq a$
    *   **反对称性 (Antisymmetric):** $\forall a, b \in S$, 如果 $a \preccurlyeq b$ 且 $b \preccurlyeq a$，则 $a = b$
    *   **传递性 (Transitive):** $\forall a, b, c \in S$, 如果 $a \preccurlyeq b$ 且 $b \preccurlyeq c$，则 $a \preccurlyeq c$
    带有偏序关系的集合 $(S, \preccurlyeq)$ 称为**偏序集 (Poset)**。
*   **上下界 (Upper and Lower Bounds):** 在偏序集 $(S, \preccurlyeq)$ 中，给定子集 $A \subseteq S$。
    *   $u \in S$ 称为 $A$ 的**上界 (Upper Bound)**，如果 $\forall a \in A, a \preccurlyeq u$。
    *   $l \in S$ 称为 $A$ 的**下界 (Lower Bound)**，如果 $\forall a \in A, l \preccurlyeq a$。
*   **最小上界 (Least Upper Bound, sup) 与最大下界 (Greatest Lower Bound, inf):**
    *   $u_0 \in S$ 称为 $A$ 的**最小上界**，如果 $u_0$ 是 $A$ 的一个上界，并且对于 $A$ 的任何其他上界 $u$，都有 $u_0 \preccurlyeq u$。如果存在，最小上界是唯一的。
    *   $l_0 \in S$ 称为 $A$ 的**最大下界**，如果 $l_0$ 是 $A$ 的一个下界，并且对于 $A$ 的任何其他下界 $l$，都有 $l \preccurlyeq l_0$。如果存在，最大下界是唯一的。

格的定义就建立在偏序集以及最小上界和最大下界的概念之上。

#### 一、格作为偏序集的定义：相交与联合

想象一个偏序集，它的元素之间有些是可比的（可以确定大小关系），有些可能不可比（比如集合 {1,2} 和 {1,3} 在包含关系下就不可比）。格的概念要求，对于**任意**两个元素，无论它们是否可比，我们都能找到它们共同的“最小上界”和“最大下界”。

*   **直观理解：**
    *   **最小上界 (Least Upper Bound, $\sup$)** 可以看作是这两个元素“合并”或“联合”后，在偏序关系意义下的最小共同“容器”。比如，在集合包含关系下，$A$ 和 $B$ 的最小上界就是 $A \cup B$；在正整数整除关系下，$a$ 和 $b$ 的最小上界就是它们的最小公倍数 $lcm(a, b)$。
    *   **最大下界 (Greatest Lower Bound, $\inf$)** 可以看作是这两个元素“相交”或“共同部分”在偏序关系意义下的最大共同“内容”。比如，在集合包含关系下，$A$ 和 $B$ 的最大下界就是 $A \cap B$；在正整数整除关系下，$a$ 和 $b$ 的最大下界就是它们的最大公约数 $gcd(a, b)$。

格的定义要求，对于任意一对元素，这种“联合”和“相交”的结果都必须存在且是唯一的。

*   **形式化定义 (定义 11.1):**
    设 $<S, \preccurlyeq>$ 是一个偏序集。如果对于任意 $x, y \in S$，子集 $\{x, y\}$ 都存在最小上界和最大下界，则称 $S$ 关于偏序 $\preccurlyeq$ 构成一个格。
    由于最小上界和最大下界是唯一的，我们可以将它们看作是关于 $x, y$ 的二元运算。
    *   $x \vee y := \sup(\{x, y\})$ （称为 $x$ 和 $y$ 的**并 (join)** 运算）
    *   $x \wedge y := \inf(\{x, y\})$ （称为 $x$ 和 $y$ 的**交 (meet)** 运算）

*   **重要注意：** 教材中强调，在本章里，符号 $\vee$ 和 $\wedge$ 不再代表逻辑上的析取（“或”）和合取（“且”），而是格中的这两种特定的二元运算。虽然在布尔代数中它们会与逻辑运算紧密联系，但在一般的格中，它们仅仅是最小上界和最大下界的符号表示。

*   **格的实例 (例 11.1, 例 11.2, 例 11.3):**
    *   **正整数因子集与整除关系:** $<S_n, D>$ 是格。$x \vee y = lcm(x, y)$, $x \wedge y = gcd(x, y)$。比如 $S_8 = \{1, 2, 4, 8\}$ 关于整除关系 D 构成的哈斯图（图 1左）。任意两元素都有 lcm 和 gcd 存在。
    *   **幂集与包含关系:** $<P(B), \subseteq>$ 是格。$X \vee Y = X \cup Y$, $X \wedge Y = X \cap Y$。这个非常直观，两个集合的最小上界（在包含关系下）自然是它们的并集，最大下界是它们的交集。
    *   **整数集与小于等于关系:** $<Z, \le>$ 是格。$x \vee y = max(x, y)$, $x \wedge y = min(x, y)$。这也是一个直观的例子。
    *   **群的子群集合与包含关系:** $<L(G), \subseteq>$ 是格。$H_1 \vee H_2 = <H_1 \cup H_2>$ (由 $H_1 \cup H_2$ 生成的最小子群)，$H_1 \wedge H_2 = H_1 \cap H_2$。子群的交集仍是子群，但子群的并集通常不是子群，需要找包含它们的最小子群。
    *   **非格的例子 (例 11.2(3) 及图 2):** 这些哈斯图清楚地展示了为什么有些偏序集不是格。例如，图 2(a) 中的 {a, b} 有上界 c, d, e，但没有唯一的最小上界。它们有下界，例如 a，但 a 并不是最大的下界，因为还有其他下界（如果存在的话），而这里 {a,b} 是不可比的，它们的最大下界是它们共同下界中最大的，图上没有。实际上，图 2(a) 的 {a, b} 连下界可能都没有共同的非平凡下界（取决于 a, b 的定义）。更清晰的例子是图 2(a) 中，a 和 b 的共同下界只有它们自己，它们不可比，没有最大下界。图 2(b) 中的 {b, d} 有下界 a, c，但没有唯一的最大下界；有上界 e，但 b 和 d 没有共同的上界（除了 e 本身，但 e 也不是最小上界，因为它们也没有共同的上界除了e）。更直接的看图 2(b)，b 和 d 的共同上界只有 e，所以最小上界是 e。但 b 和 d 的共同下界有 a 和 c，这两个不可比，所以 {b, d} 没有*最大*下界。图 2(c) 中的 {b, c} 只有上界 e，所以最小上界是 e。下界有 a，且 a 是唯一的下界，所以最大下界是 a。所以 (c) 是格！**检查教材原文**：教材说图 2(c) 的 {b, c} 没有最小上界，这是错误的。b 和 c 的上界只有 e，所以最小上界是 e。b 和 c 的下界只有 a，所以最大下界是 a。因此图 2(c) **是格**。**再检查教材原文**：哦，我看到图 2(c) 下面的解说写着 "( c ) 的 { b , c } 没有最小上界 ." 这是和图示以及定义相悖的。b 和 c 的上界集合是 {e}，所以最小上界是 e。它们的下界集合是 {a}，所以最大下界是 a。请你**务必注意**，根据格的定义，图 2(c) **是格**。这是教材中的一处明显错误。**更正：** 仔细看图 2(c)，元素是 a, b, c, e。关系是 a $\preccurlyeq$ b, a $\preccurlyeq$ c, b $\preccurlyeq$ e, c $\preccurlyeq$ e。b和c的共同上界只有e，所以最小上界是e。b和c的共同下界只有a，所以最大下界是a。因此图 2(c) **是格**。教材的图 2(c) 可能画错了或者文字描述错了。我们以**定义**为准来判断。图 2(a) {a, b} 的上界是 {c, d, e}，它们不可比，没有最小上界。图 2(b) {b, d} 的下界是 {a, c}，它们不可比，没有最大下界。图 2(d) {a, g} 的下界只有自身 a, g (如果存在共同下界的话)，图示中a和g的共同下界是c和d，c和d不可比，没有最大下界。所以图 2(a), (b), (d) **不是格**，理由正确。图 2(c) **是格**，教材描述错误。

*   **格作为代数系统的定义 (定义 11.3):**
    教材也提到了格可以定义为一个代数系统 $<S, *, \circ>$ 带有两个二元运算 * 和 $\circ$，如果它们满足交换律、结合律和吸收律。这说明格有两种等价的定义方式：一种是基于偏序集，另一种是基于代数运算。这两种观点是互补的，理解它们的等价性有助于深入理解格的性质。偏序集的定义更直观地展现了格的“结构”或“形状”，而代数系统的定义则便于进行形式化的代数运算和证明。

#### 二、格的性质：运算与序的交织

格的定义虽然简单，但基于它，我们可以推导出许多重要的运算性质和关于序的性质。

*   **对偶原理 (Dual Principle):**
    *   **对偶命题 (定义 11.2):** 如果一个命题 $f$ 中包含格的元素和符号 $=, \preccurlyeq, \succcurlyeq, \vee, \wedge$，将其中的 $\preccurlyeq$ 换成 $\succcurlyeq$，$\succcurlyeq$ 换成 $\preccurlyeq$，$\vee$ 换成 $\wedge$，$\wedge$ 换成 $\vee$（以及 0 换 1，1 换 0，后面会讲到），就得到它的对偶命题 $f^*$。例如，$(a \vee b) \wedge c \preccurlyeq c$ 的对偶命题是 $(a \wedge b) \vee c \succcurlyeq c$。
    *   **格的对偶原理:** 如果命题 $f$ 对一切格都为真，那么它的对偶命题 $f^*$ 也对一切格都为真。
    *   **为什么对偶原理成立？** 从偏序集定义来看，格的定义是关于最小上界和最大下界对称的。如果我们把偏序关系 $\preccurlyeq$ 翻转过来变成 $\succcurlyeq$（即定义 $x \succcurlyeq y \Leftrightarrow y \preccurlyeq x$），那么原来的最小上界就会变成新的关系下的最大下界，原来的最大下界会变成新的关系下的最小上界。因此，如果一个偏序集构成格，那么它在翻转后的关系下也构成格。一个关于 $\preccurlyeq, \vee, \wedge$ 的命题 $f$ 在原格中为真，等价于它在翻转后的格中为真。而 $f^*$ 正是把 $f$ 中的符号进行这种翻转，所以在翻转后的格中，证明 $f$ 等价于证明 $f^*$ 在原格中。由于原格和翻转后的格都满足格的定义，所以如果 $f$ 对所有格都真，那么 $f^*$ 也对所有格都真。
    *   **用途:** 对偶原理是格理论中一个非常方便的工具。如果我们要证明一对互为对偶的定理，只需要证明其中一个，另一个就自动成立了。

*   **运算性质 (定理 11.1):**
    格的运算 $\vee$ 和 $\wedge$ 满足：
    (1) **交换律 (Commutative Law):** $a \vee b = b \vee a$, $a \wedge b = b \wedge a$. （证明：由集合 $\{a, b\} = \{b, a\}$ 的最小上界和最大下界唯一性直接得出。）
    
    (2) **结合律 (Associative Law):** $(a \vee b) \vee c = a \vee (b \vee c)$, $(a \wedge b) \wedge c = a \wedge (b \wedge c)$. （证明：需要证明 $(a \vee b) \vee c$ 是 $\{a, b, c\}$ 的最小上界。由定义 $(a \vee b) \vee c \preccurlyeq a \vee b \preccurlyeq a$ 是不对的，应该是 $\succcurlyeq$。证明思路：要证 $(a \vee b) \vee c = a \vee (b \vee c)$，我们可以证明 $(a \vee b) \vee c$ 是集合 $\{a, b, c\}$ 的最小上界。首先，$(a \vee b) \vee c \succcurlyeq a \vee b \succcurlyeq a$ 和 $(a \vee b) \vee c \succcurlyeq a \vee b \succcurlyeq b$，以及 $(a \vee b) \vee c \succcurlyeq c$。因此 $(a \vee b) \vee c$ 是 $\{a, b, c\}$ 的上界。现在设 $u$ 是 $\{a, b, c\}$ 的任意上界，即 $a \preccurlyeq u, b \preccurlyeq u, c \preccurlyeq u$。由 $a \preccurlyeq u$ 和 $b \preccurlyeq u$ 得 $a \vee b \preccurlyeq u$。再由 $a \vee b \preccurlyeq u$ 和 $c \preccurlyeq u$ 得 $(a \vee b) \vee c \preccurlyeq u$。所以 $(a \vee b) \vee c$ 是最小上界。同理可证 $a \vee (b \vee c)$ 也是 $\{a, b, c\}$ 的最小上界。由于最小上界唯一，所以 $(a \vee b) \vee c = a \vee (b \vee c)$。再由对偶原理得 $(a \wedge b) \wedge c = a \wedge (b \wedge c)$。）
    
    (3) **幂等律 (Idempotent Law):** $a \vee a = a$, $a \wedge a = a$. （证明：显然 $a$ 是 $\{a, a\}$ 的上界，也是下界。根据最小上界和最大下界的定义， $a$ 就是最小上界和最大下界。）
    
    (4) **吸收律 (Absorption Law):** $a \vee (a \wedge b) = a$, $a \wedge (a \vee b) = a$. （证明：$a \wedge b$ 是 $a$ 和 $b$ 的最大下界，所以 $a \wedge b \preccurlyeq a$。要证 $a \vee (a \wedge b) = a$。由定义，最小上界 $\preccurlyeq$ 任何上界。显然 $a$ 是 $a$ 和 $a \wedge b$ 的上界（因为 $a \preccurlyeq a$ 且 $a \wedge b \preccurlyeq a$）。所以 $a \vee (a \wedge b) \preccurlyeq a$. 另一方面，最小上界必须大于等于参与运算的元素，所以 $a \vee (a \wedge b) \succcurlyeq a$. 根据偏序的反对称性， $a \vee (a \wedge b) = a$. 由对偶原理得 $a \wedge (a \vee b) = a$.）

    理解这些性质的证明思路非常重要。它们都不是凭空得出的公式，而是由格作为偏序集定义推导出来的必然结果。吸收律尤其体现了偏序结构带来的特殊性：当一个元素已经是另一个元素的上界或下界时，它们的联合或交汇结果就是那个“更大”或“更小”的元素。

*   **关于序的性质 (定理 11.2):**
    在格 $L$ 中，对于任意 $a, b \in L$，以下三个条件是等价的：
    $a \preccurlyeq b \Leftrightarrow a \wedge b = a \Leftrightarrow a \vee b = b$.
    （证明：教材中给出了一个漂亮的循环证明链：$a \preccurlyeq b \implies a \wedge b = a \implies a \vee b = b \implies a \preccurlyeq b$. 这个证明非常清晰地展示了格运算与偏序关系的紧密联系。比如 $a \preccurlyeq b \implies a \wedge b = a$: 如果 $a \preccurlyeq b$，那么 $a$ 是 $\{a, b\}$ 的下界。同时 $a$ 是 $\{a, b\}$ 的一个元素，显然 $a \preccurlyeq a$. 那么 $a$ 是 $\{a, b\}$ 的一个下界。任何 $\{a, b\}$ 的下界 $l$ 都满足 $l \preccurlyeq a$ 且 $l \preccurlyeq b$. 由于 $a \preccurlyeq b$, $l \preccurlyeq b$ 自动满足如果 $l \preccurlyeq a$. 所以 $a$ 是 $\{a, b\}$ 的下界集合中最大的，即最大下界 $a \wedge b = a$. 其他部分的证明也请仔细推导，加深理解。）

*   **单调性 (定理 11.3):**
    设 $L$ 是格，$\forall a, b, c, d \in L$. 若 $a \preccurlyeq b$ 且 $c \preccurlyeq d$，则 $a \wedge c \preccurlyeq b \wedge d$ 且 $a \vee c \preccurlyeq b \vee d$.
    （证明：这个证明也很直观。$a \wedge c$ 既小于等于 $a$ 也小于等于 $c$. 因为 $a \preccurlyeq b$ 且 $c \preccurlyeq d$，所以 $a \wedge c \preccurlyeq a \preccurlyeq b$ 且 $a \wedge c \preccurlyeq c \preccurlyeq d$. 因此 $a \wedge c$ 是 $b$ 和 $d$ 的共同下界。根据最大下界的定义，$a \wedge c$ 必然小于等于 $b$ 和 $d$ 的最大下界，即 $a \wedge c \preccurlyeq b \wedge d$. 对偶地证明 $a \vee c \preccurlyeq b \vee d$.)

*   **分配不等式 (例 11.5):**
    在任何格中，恒有 $a \vee (b \wedge c) \preccurlyeq (a \vee b) \wedge (a \vee c)$.
    （证明：利用单调性。$b \wedge c \preccurlyeq b$, 结合 $a \preccurlyeq a$, 由单调性得 $a \vee (b \wedge c) \preccurlyeq a \vee b$. 同理，$b \wedge c \preccurlyeq c$, 结合 $a \preccurlyeq a$, 由单调性得 $a \vee (b \wedge c) \preccurlyeq a \vee c$. 由于 $a \vee (b \wedge c)$ 同时小于等于 $a \vee b$ 和 $a \vee c$，它就是 $\{a \vee b, a \vee c\}$ 的共同下界。根据最大下界的定义，$a \vee (b \wedge c)$ 必然小于等于它们的最大下界 $(a \vee b) \wedge (a \vee c)$.）
    **重要提示：** 这个不等式的等号在一般的格中不一定成立！只有满足这个等号的格才叫做分配格。教材中 L3 (钻石格) 和 L4 (五角格) 的例子 (例 11.6) 清楚地说明了这一点。

#### 三、子格：更小的结构

*   **定义 (定义 11.4):**
    设 $<L, \preccurlyeq>$ 是格， $S$ 是 $L$ 的非空子集。如果 $S$ 关于 $L$ 中定义的运算 $\vee$ 和 $\wedge$ 是封闭的（即 $\forall x, y \in S$, $x \vee y \in S$ 且 $x \wedge y \in S$），则称 $S$ 是 $L$ 的子格。
*   **关键点:** 判断一个子集是否是子格，不是看子集本身是否构成格，而是看子集在**原格**的运算下是否封闭。子集自身可能构成格，但在原格运算下不封闭，那就不是子格。
*   **实例 (例 11.4):**
    $S_{30} = \{1, 2, 3, 5, 6, 10, 15, 30\}$ 关于整除关系是格。
    $L_1 = \{1, 2, 3, 6\}$. 检查：$2 \vee 3 = lcm(2, 3) = 6 \in L_1$, $2 \wedge 3 = gcd(2, 3) = 1 \in L_1$. 其他任意两元素的 $\vee, \wedge$ 也在 $L_1$ 中。所以 $L_1$ 是 $S_{30}$ 的子格。
    $L_2 = \{1, 2, 3\}$. $2 \vee 3 = 6$. $6 \notin L_2$. 所以 $L_2$ 不是 $S_{30}$ 的子格。
    $L_3 = \{1, 2, 5, 6, 15, 30\}$. $2 \vee 5 = lcm(2, 5) = 10$. $10 \notin L_3$. 所以 $L_3$ 不是 $S_{30}$ 的子格。教材说 $L_3$ 本身构成格，这是可能的，但它不是 $S_{30}$ 的子格。
*   **习题 (练习 2):** 证明 $\{x \mid x \in L, x \preccurlyeq a\}$ 是 $L$ 的子格。证明很简单，如果 $x \preccurlyeq a$ 且 $y \preccurlyeq a$，那么由单调性可知 $x \wedge y \preccurlyeq a \wedge a = a$ 且 $x \vee y \preccurlyeq a \vee a = a$. 所以 $x \wedge y$ 和 $x \vee y$ 都在这个集合中。

#### 五、格同态：保持结构的映射

*   **定义 (定义 11.5):**
    设 $L_1$ 和 $L_2$ 是格，$f: L_1 \to L_2$ 是一个映射。如果对于任意 $a, b \in L_1$，都有：
    $f(a \wedge b) = f(a) \wedge f(b)$
    $f(a \vee b) = f(a) \vee f(b)$
    则称 $f$ 为格同态。它要求映射保持格的两种运算。
*   **性质 (定理 11.5):**
    (1) 格同态是保序映射：如果 $f$ 是格同态，那么 $a \preccurlyeq b \implies f(a) \preccurlyeq f(b)$. （证明：如果 $a \preccurlyeq b$，由定理 11.2 知 $a \vee b = b$. 因为 $f$ 是同态， $f(a \vee b) = f(a) \vee f(b)$. 所以 $f(b) = f(a) \vee f(b)$. 由定理 11.2 知 $f(a) \preccurlyeq f(b)$.)
    (2) 如果 $f$ 是双射，那么 $f$ 是格同态当且仅当 $f$ 是保序同构（即 $a \preccurlyeq b \Leftrightarrow f(a) \preccurlyeq f(b)$）。双射且保序的映射称为**格同构**。格同构意味着两个格在结构上是完全一样的，只是元素的“标签”不同。
*   **实例 (例 11.5):**
    例 11.5(1) 中的 $f(x) = x-1$ 是保序的 ($x \le y \implies x-1 \le y-1$) 且保持 min/max 运算，因此是格同态。
    例 11.5(2) 中的 $f_1, f_2$ 不是格同态，因为它们不保持 $\vee$ 运算（教材给出的例子是 $f_1(b \vee c) \ne f_1(b) \vee f_1(c)$，图 4 中 $b \vee c = d$ 在 $L_1$ 中，而 $f_1(b)=a_1, f_1(c)=a_1$ 在 $L_2$ 中， $a_1 \vee a_1 = a_1$。$f_1(d)=d_1$。$d_1 \ne a_1$。所以 $f_1$ 不是同态。$f_2$ 同理）。

#### 六、格的直积：组合结构

*   **定义 (定义 11.6):**
    设 $L_1$ 和 $L_2$ 是格，在笛卡尔积 $L_1 \times L_2$ 上定义运算 $\cap$ 和 $\cup$（教材用 $\cap, \cup$ 代表直积上的运算，可能为了和 $L_1, L_2$ 的运算区分，但本质上是应用各自的运算）：
    $<a_1, b_1> \cap <a_2, b_2> = <a_1 \wedge_1 a_2, b_1 \wedge_2 b_2>$
    $<a_1, b_1> \cup <a_2, b_2> = <a_1 \vee_1 a_2, b_1 \vee_2 b_2>$
    其中 $\wedge_1, \vee_1$ 是 $L_1$ 的运算，$\wedge_2, \vee_2$ 是 $L_2$ 的运算。称 $<L_1 \times L_2, \cap, \cup>$ 为格 $L_1$ 和 $L_2$ 的直积。
*   **性质:** 格的直积仍然是格。其偏序关系是分量上的偏序关系的组合：$<a_1, b_1> \preccurlyeq <a_2, b_2> \Leftrightarrow a_1 \preccurlyeq_1 a_2$ 且 $b_1 \preccurlyeq_2 b_2$.
*   **实例:** L = <{0, 1}, $\le$>. 这是最小的非平凡链格。$L \times L = \{<0,0>, <0,1>, <1,0>, <1,1>\}$. 其偏序关系为：$<0,0> \preccurlyeq <0,1>$, $<0,0> \preccurlyeq <1,0>$, $<0,1> \preccurlyeq <1,1>$, $<1,0> \preccurlyeq <1,1>$. 这与幂集格 $<P(\{a, b\}), \subseteq>$ 是同构的，其中 $<0,0>$ 对应 $\emptyset$, $<0,1>$ 对应 $\{b\}$, $<1,0>$ 对应 $\{a\}$, $<1,1>$ 对应 $\{a, b\}$. 这是一个重要的例子，它揭示了直积结构与幂集结构的一种联系，为后面的布尔代数表示定理埋下了伏笔。

#### 一、分配格：运算可以“展开”的格

之前提到了分配不等式 $a \vee (b \wedge c) \preccurlyeq (a \vee b) \wedge (a \vee c)$ 在所有格中都成立。分配格则要求这个不等式变成等式，并且其对偶形式也成立。

*   **定义 (定义 11.7):**
    设 $<L, \wedge, \vee>$ 是格。如果对于任意 $a, b, c \in L$，以下两个分配律中的一个成立，则称 $L$ 为分配格：
    1.  $a \wedge (b \vee c) = (a \wedge b) \vee (a \wedge c)$
    2.  $a \vee (b \wedge c) = (a \vee b) \wedge (a \vee c)$
    **注意：** 教材中提到“以上条件互为充分必要条件”。这意味着如果格满足第一个等式，则必然满足第二个；反之亦然。所以在证明一个格是分配格时，只需要验证其中一个分配律即可。

*   **实例 (例 11.6, 图 5):**
    $L_1$ 和 $L_2$ (都是链) 是分配格。链非常简单，容易验证分配律。
    $L_3$ (钻石格) 和 $L_4$ (五角格) 不是分配格。教材提供了具体的反例：
    *   在 $L_3$ 中，$b \wedge (c \vee d) = b \wedge e = b$。$(b \wedge c) \vee (b \wedge d) = a \vee a = a$. $b \ne a$. 所以 $b \wedge (c \vee d) \ne (b \wedge c) \vee (b \wedge d)$.
    *   在 $L_4$ 中，$c \vee (b \wedge d) = c \vee a = c$。$(c \vee b) \wedge (c \vee d) = e \wedge d = d$. $c \ne d$. 所以 $c \vee (b \wedge d) \ne (c \vee b) \wedge (c \vee d)$.

*   **分配格的判别 (定理 11.6):**
    设 $L$ 是格。则 $L$ 是分配格当且仅当 $L$ 不含有与钻石格 $L_3$ 或五角格 $L_4$ 同构的子格。
    **理解这个定理：** 这个定理非常强大。它告诉我们，一个格是不是分配格，完全取决于它内部有没有这两种特殊的“非分配”结构。钻石格和五角格是最小的非分配格。任何非分配格都必然包含它们之一作为子结构。这提供了一种通过检查子格来判断分配性的方法。
    *   **推论:**
        (1) 小于五元的格都是分配格。（因为 $L_3$ 和 $L_4$ 都有 5 个元素，所以元素个数少于 5 的格不可能包含它们作为子格。）
        (2) 任何一条链都是分配格。（链的结构非常简单，无法形成钻石或五角形状。）

*   **另一个判别定理 (定理 11.7):**
    格 $L$ 是分配格当且仅当 $\forall a, b, c \in L$, 如果 $a \wedge b = a \wedge c$ 且 $a \vee b = a \vee c$，则 $b = c$.
    **理解这个定理：** 这可以看作是分配格的一种“消去律”性质。在一般格中不一定成立。证明思路：必要性（分配格 $\implies$ 性质）利用分配律进行推导。充分性（性质 $\implies$ 分配格）利用反证法，假设 $L$ 不是分配格，则必含有钻石格或五角格作为子格，然后在这些子格中找到违反该性质的例子。比如在钻石格 $L_3$ 中，取 $a$ 为底部元素， $b, c, d$ 是中间三个元素（教材例子中是 b, c, d），e 为顶部元素。则 $a \wedge c = a \wedge d = a$ (底部元素)，$a \vee c = a \vee d = c \vee d$ (中间两个元素的并) 也是不对的，应该取 a 为中间元素 x，b, c 为 y, z。在钻石格 {u, v, x, y, z} 中，u是底，v是顶，x, y, z是中间层且两两并为v，两两交为u。取 $a=x, b=y, c=z$. 则 $a \wedge b = x \wedge y = u$, $a \wedge c = x \wedge z = u$. $a \vee b = x \vee y = v$, $a \vee c = x \vee z = v$. 所以 $a \wedge b = a \wedge c$ 且 $a \vee b = a \vee c$，但 $b=y \ne z=c$. 这就违反了定理 11.7 的性质。因此，如果一个格满足定理 11.7 的性质，它就不会含有钻石格或五角格，从而必然是分配格。

#### 二、有补格：每个元素都有“反面”

*   **有界格 (Bounded Lattice):**
    *   **全下界 (Universal Lower Bound / Zero Element):** 存在元素 0 使得 $\forall x \in L, 0 \preccurlyeq x$. (定义 11.8)
    *   **全上界 (Universal Upper Bound / One Element):** 存在元素 1 使得 $\forall x \in L, x \preccurlyeq 1$. (定义 11.8)
    *   **有界格 (定义 11.9):** 同时存在全下界和全上界的格。记为 $<L, \wedge, \vee, 0, 1>$.
    *   **性质 (定理 11.8):** 在有界格中，0 是 $\wedge$ 运算的零元 ($a \wedge 0 = 0$) 和 $\vee$ 运算的单位元 ($a \vee 0 = a$). 1 是 $\vee$ 运算的零元 ($a \vee 1 = 1$) 和 $\wedge$ 运算的单位元 ($a \wedge 1 = a$). (证明：利用定理 11.2 中的 $a \preccurlyeq b \Leftrightarrow a \wedge b = a \Leftrightarrow a \vee b = b$. 例如，因为 $0 \preccurlyeq a$ 对所有 $a$ 成立，所以 $0 \vee a = a$ 且 $0 \wedge a = 0$.)
    *   **注意:** 有限格（元素个数有限的格）总是存在全下界和全上界。全下界是所有元素的 $\wedge$，全上界是所有元素的 $\vee$.
    *   **对偶原理的扩展:** 在涉及有界格的命题中，求对偶时 0 和 1 也需要互换。

*   **补元 (Complement):**
    *   **定义 (定义 11.10):** 在有界格 $<L, \wedge, \vee, 0, 1>$ 中，对于元素 $a \in L$，如果存在 $b \in L$ 使得 $a \wedge b = 0$ 且 $a \vee b = 1$，则称 $b$ 是 $a$ 的补元。
    *   **注意:** 补元不一定存在，即使存在也不一定唯一 (例 11.8, 图 8 中的 L3, L4)。全下界 0 和全上界 1 总是互为补元。

*   **有界分配格中补元的唯一性 (定理 11.9):**
    设 $<L, \wedge, \vee, 0, 1>$ 是有界分配格。若 $L$ 中元素 $a$ 存在补元，则补元是唯一的。
    （证明：这是分配律的一个非常重要的后果。假设 $b$ 和 $c$ 都是 $a$ 的补元。则 $a \wedge b = 0, a \vee b = 1$ 且 $a \wedge c = 0, a \vee c = 1$. 我们要证明 $b=c$. 利用分配律和已知条件进行推导：
    $b = b \vee 0$ (定理 11.8)
    $= b \vee (a \wedge c)$ (已知 $a \wedge c = 0$)
    $= (b \vee a) \wedge (b \vee c)$ (分配律)
    $= (a \vee b) \wedge (b \vee c)$ (交换律)
    $= 1 \wedge (b \vee c)$ (已知 $a \vee b = 1$)
    $= b \vee c$ (定理 11.8)
    同理可证 $c = c \vee 0 = c \vee (a \wedge b) = (c \vee a) \wedge (c \vee b) = (a \vee c) \wedge (c \vee b) = 1 \wedge (c \vee b) = c \vee b$.
    我们得到 $b = b \vee c$ 和 $c = c \vee b$. 由定理 11.2 的对偶形式 ($x = x \vee y \Leftrightarrow y \preccurlyeq x$)， $b = b \vee c$ 意味着 $c \preccurlyeq b$, 而 $c = c \vee b$ 意味着 $b \preccurlyeq c$. 根据偏序的反对称性， $b = c$.）
    **核心思想：** 分配律赋予了格足够的“结构”，使得元素之间的关系更加确定，从而排除了补元不唯一的可能性。

*   **有补格 (Complemented Lattice):**
    *   **定义 (定义 11.11):** 设 $<L, \wedge, \vee, 0, 1>$ 是有界格。如果 $L$ 中所有元素都存在补元，则称 $L$ 为有补格。
    *   **注意:** 有补格不要求是分配格，比如钻石格 $L_3$ 如果有界且所有元素都有补元，它就是有补格（在对称的钻石格中，中间三个元素互为补元，顶和底互补）。图 9 中的 L2, L3, L4 都展示了有补格（虽然 L3, L4 不是分配格，它们的补元可能不唯一）。L1 不是有补格因为它的一些元素（例如中间的 b）没有补元。

#### 一、布尔代数：理想的结构

布尔代数结合了格的运算和序的性质，并加入了分配律和补元的概念，形成了一种非常“完备”且“理想”的代数结构，它完美地契合了逻辑运算和集合运算的性质。

*   **布尔代数的格定义 (定义 11.12):**
    如果一个格是有补的分配格，则称它为布尔格或布尔代数。
    **关键点:** 布尔代数 = 格 + 分配律 + 有界性 + 每个元素都有补元。
    由于布尔代数是有界分配格，根据定理 11.9，其中每个元素的补元都是唯一的。因此，求补元可以看作是一个定义良好的**一元运算**。
    布尔代数通常记为 $<B, \wedge, \vee, \neg, 0, 1>$ 或 $<B, \wedge, \vee, ', 0, 1>$，其中 $\neg$ 或 $'$ 表示求补运算。

*   **实例:**
    *   **正整数因子集 $S_n$:** $<S_n, gcd, lcm>$ 构成布尔代数当且仅当 $n$ 是**无平方因子**的整数（square-free integer）。比如 $110 = 2 \times 5 \times 11$, 没有重复的素因子，所以 $S_{110}$ 构成布尔代数。$S_8 = \{1, 2, 4, 8\}$, $8=2^3$ 有平方因子 $4$. $S_8$ 关于整除是格，也是有界格 (0=1, 1=8)。它是链，所以是分配格。但它不是有补格，例如元素 2 的补元 $x$ 需满足 $gcd(2, x)=1$ 且 $lcm(2, x)=8$. $lcm(2, x)=8$ 要求 $x$ 是 4 或 8 (或 $2^k$)。$gcd(2, 4)=2 \ne 1$, $gcd(2, 8)=2 \ne 1$. 所以 2 没有补元。
    *   **幂集格:** $<P(B), \cap, \cup, \emptyset, B>$ 是布尔代数。我们已经知道它是格，它是分配格 (集合的交和并满足分配律)，它有界 (全下界 $\emptyset$, 全上界 $B$). 任意子集 $X \subseteq B$ 的补元是其绝对补集 $B \setminus X = \overline{X}$. $X \cap \overline{X} = \emptyset$ 且 $X \cup \overline{X} = B$. 所以每个元素都有补元。幂集格是一个典型的布尔代数。

*   **布尔代数的性质:** 布尔代数继承了格的所有性质，特别是分配律和补元的唯一性使得它具有更多强大的性质。
    *   **德摩根律 (De Morgan's Laws, 定理 11.10):**
        $\forall a, b \in B$, $(a \wedge b)' = a' \vee b'$, $(a \vee b)' = a' \wedge b'$.
        （证明 $(a \wedge b)' = a' \vee b'$：要证明 $a' \vee b'$ 是 $a \wedge b$ 的补元。根据补元定义，需要证明 $(a \wedge b) \wedge (a' \vee b') = 0$ 且 $(a \wedge b) \vee (a' \vee b') = 1$. 利用分配律、结合律、交换律、补元定义和单位元性质：
        $(a \wedge b) \wedge (a' \vee b') = ((a \wedge b) \wedge a') \vee ((a \wedge b) \wedge b')$ (分配律)
        $= (a \wedge (b \wedge a')) \vee (a \wedge (b \wedge b'))$ (结合律)
        $= (a \wedge (a' \wedge b)) \vee (a \wedge 0)$ (交换律, 补元定义 $b \wedge b' = 0$)
        $= ((a \wedge a') \wedge b) \vee 0$ (结合律, 定理 11.8 $a \wedge 0 = 0$)
        $= (0 \wedge b) \vee 0$ (补元定义 $a \wedge a' = 0$)
        $= 0 \vee 0$ (定理 11.8 $0 \wedge b = 0$)
        $= 0$ (幂等律或定理 11.8)
        $(a \wedge b) \vee (a' \vee b') = (a \vee (a' \vee b')) \wedge (b \vee (a' \vee b'))$ (分配律)
        $= ((a \vee a') \vee b') \wedge ((b \vee b') \vee a')$ (结合律, 交换律)
        $= (1 \vee b') \wedge (1 \vee a')$ (补元定义)
        $= 1 \wedge 1$ (定理 11.8 $1 \vee x = 1$)
        $= 1$ (幂等律或定理 11.8)
        由于 $a' \vee b'$ 满足补元的条件，且布尔代数中补元唯一，所以 $(a \wedge b)' = a' \vee b'$. 另一条德摩根律由对偶原理得出或类似证明。）
    *   **序与补元的关系 (定理):**
        $\forall a, b \in B$, $a \preccurlyeq b \Leftrightarrow a \wedge b' = 0 \Leftrightarrow a' \vee b = 1$.
        （证明 $a \preccurlyeq b \Leftrightarrow a \wedge b' = 0$:
        $\implies$: 假设 $a \preccurlyeq b$. 要证 $a \wedge b' = 0$. $a \wedge b' \preccurlyeq b \wedge b'$ (单调性) $= 0$ (补元定义). 因为 0 是全下界，任何元素都大于等于 0，所以 $a \wedge b' \succcurlyeq 0$. 由反对称性得 $a \wedge b' = 0$.
        $\impliedby$: 假设 $a \wedge b' = 0$. 要证 $a \preccurlyeq b$. 由定理 11.2，只需证 $a \vee b = b$.
        $a \vee b = a \vee (1 \wedge b)$ (定理 11.8)
        $= a \vee ((a' \vee a) \wedge b)$ (补元定义)
        $= a \vee ((a' \wedge b) \vee (a \wedge b))$ (分配律)
        $= (a \vee (a' \wedge b)) \vee (a \wedge b)$ (结合律)
        $= ((a \vee a') \wedge (a \vee b)) \vee (a \wedge b)$ (分配律 - 注意这里用了 $a \vee (x \wedge y) = (a \vee x) \wedge (a \vee y)$, 这是分配格的性质)
        $= (1 \wedge (a \vee b)) \vee (a \wedge b)$ (补元定义)
        $= (a \vee b) \vee (a \wedge b)$ (定理 11.8)
        $= a \vee b$ (吸收律)
        这个证明似乎没有达到 $a \vee b = b$ 的结论。换一个思路：
        假设 $a \wedge b' = 0$. 要证 $a \preccurlyeq b$. 由定理 11.2，等价于证 $a \vee b = b$.
        考虑 $a \vee b$. 我们知道 $b \preccurlyeq a \vee b$. 只需要证 $a \vee b \preccurlyeq b$.
        $a \vee b = (a \vee b) \wedge 1 = (a \vee b) \wedge (b \vee b') = b \vee (a \wedge b')$.
        如果 $a \wedge b' = 0$, 那么 $a \vee b = b \vee 0 = b$. 得证 $a \preccurlyeq b \Leftrightarrow a \wedge b' = 0$.
        $a' \vee b = 1 \Leftrightarrow (a' \vee b)' = 1' = 0 \Leftrightarrow a'' \wedge b' = 0 \Leftrightarrow a \wedge b' = 0$. 所以 $a \wedge b' = 0 \Leftrightarrow a' \vee b = 1$.
        这些等价关系在布尔代数中非常常用，尤其是在逻辑推理和集合论中，它们对应着蕴含关系 $a \to b \equiv \neg a \vee b$ 以及 $a \subseteq b \Leftrightarrow a \cap b^c = \emptyset \Leftrightarrow a^c \cup b = U$.）

*   **布尔代数作为代数系统的定义 (定义 11.13):**
    布尔代数也可以定义为一个代数系统 $<B, *, \circ, ', 0, 1>$ 带有两个二元运算 * 和 $\circ$ 以及一个一元运算 '，满足：
    (1) 交换律 (*, $\circ$)
    (2) 分配律 (* 对 $\circ$, $\circ$ 对 *)
    (3) 同一律 (存在单位元 0 对 $\circ$, 1 对 *)
    (4) 补元律 ($\forall a$, 存在 $a'$ 使得 $a * a' = 0, a \circ a' = 1$)
    这个定义与基于格的定义是等价的。从这个定义出发，可以证明吸收律、幂等律等格的基本性质。这两种定义提供了从不同角度理解布尔代数的途径。

#### 四、布尔代数的子代数：布尔结构的嵌套

*   **定义 (定义 11.14):**
    设 $<B, \wedge, \vee, \neg, 0, 1>$ 是布尔代数，$S$ 是 $B$ 的非空子集。如果 $0 \in S$, $1 \in S$，且 $S$ 对 $\wedge, \vee, \neg$ 运算都是封闭的，则称 $S$ 是 $B$ 的子布尔代数。
    **关键点:** 子布尔代数不仅要求对二元运算封闭，还要包含原布尔代数的 0 和 1，并且对补元运算封闭（这里的补元运算是指**原布尔代数**的补元运算）。
*   **实例:**
    *   区间 $[a, b]$ (定义为 $\{x \mid x \in B, a \preccurlyeq x \preccurlyeq b\}$) 在自身定义的运算下可以构成一个布尔代数，其全下界是 $a$，全上界是 $b$，元素 $x$ 的补元是 $(a \vee x') \wedge b$. 但它**不是**原布尔代数 $B$ 的子布尔代数，除非 $a=0, b=1$ (此时 $[0, 1]=B$)。因为它不包含原布尔代数的 0 或 1 (除非 $a=0$ 或 $b=1$)，而且其补元运算与原布尔代数的补元运算不同 (例如，当 $a=0, b<1$ 时，[0,b] 的全上界是 b，b 的补元是 a=0。但在原布尔代数 B 中，b 的补元 b' 通常不是 0)。
    *   $S_{110}$ 的子布尔代数例子：$\{1, 110\}$ 是子代数 ($1'=110, 1 \wedge 110 = 1, 1 \vee 110 = 110$). $\{1, 2, 55, 110\}$ 也是子代数 ($1'=110, 2'=55, 55'=2, 110'=1$, $1, 110 \in \{1, 2, 55, 110\}$, $\wedge, \vee$ 封闭). 这些子代数都对应于 $S_{110}$ 原子集合 $\{2, 5, 11\}$ 的幂集的子代数结构。

#### 五、布尔代数的同态映射：保持布尔结构的映射

*   **定义 (定义 11.15):**
    设 $<B_1, \wedge_1, \vee_1, \neg_1, 0_1, 1_1>$ 和 $<B_2, \wedge_2, \vee_2, \neg_2, 0_2, 1_2>$ 是两个布尔代数，$f: B_1 \to B_2$ 是一个映射。如果对于任意 $a, b \in B_1$，都有：
    $f(a \wedge_1 b) = f(a) \wedge_2 f(b)$
    $f(a \vee_1 b) = f(a) \vee_2 f(b)$
    $f(\neg_1 a) = \neg_2 f(a)$
    则称 $f$ 是布尔代数同态。
    布尔代数同态会自动保持 0 和 1：$f(0_1) = f(a \wedge_1 \neg_1 a) = f(a) \wedge_2 f(\neg_1 a) = f(a) \wedge_2 \neg_2 f(a) = 0_2$. 同理 $f(1_1) = f(a \vee_1 \neg_1 a) = f(a) \vee_2 f(\neg_1 a) = f(a) \vee_2 \neg_2 f(a) = 1_2$.

*   **简化条件 (例):**
    为证明 $f: B_1 \to B_2$ 是布尔代数同态，只需验证保持其中一个二元运算（例如 $\wedge$ 或 $\vee$）和保持补元运算即可。
    例如，若 $f(a \wedge b) = f(a) \wedge f(b)$ 且 $f(a') = f(a)'$，则：
    $f(a \vee b) = f((a' \wedge b')') $ (德摩根律和双重否定律)
    $= f(a' \wedge b')'$ (保持补元)
    $= (f(a') \wedge f(b'))'$ (保持 $\wedge$)
    $= (f(a)' \wedge f(b)')'$ (保持补元)
    $= f(a)'' \vee f(b)''$ (德摩根律)
    $= f(a) \vee f(b)$ (双重否定律)
    得证 $f$ 保持 $\vee$ 运算。

#### 六、有限布尔代数的结构：原子与表示定理

有限布尔代数具有非常简洁且美丽的结构，它们都可以用幂集代数来表示。

*   **原子 (Atom):**
    *   **定义 (定义 11.16):** 设 $L$ 是格，$0 \in L$. 若元素 $a \in L$ 满足 $0 \prec a$（即 $0 \preccurlyeq a$ 且 $0 \ne a$），并且不存在元素 $b \in L$ 使得 $0 \prec b \prec a$，则称 $a$ 是 $L$ 中的原子。原子是大于 0 的最小元素。
    *   **实例:**
        *   $S_n$ 关于整除：原子是 $n$ 的素因子。例如 $S_{110} = \{1, 2, 5, 10, 11, 22, 55, 110\}$，原子是 2, 5, 11。
        *   幂集 $P(B)$：原子是集合 $B$ 中单个元素构成的单元集（单点集）。例如 $P(\{a, b\})$ 的原子是 $\{a\}$ 和 $\{b\}$。

*   **有限布尔代数的表示定理 (定理 11.11):**
    设 $B$ 是有限布尔代数，$A$ 是 $B$ 的全体原子构成的集合。则 $B$ 同构于 $A$ 的幂集代数 $P(A)$.
    **理解这个定理：** 这是布尔代数理论中最重要的结果之一。它告诉我们，从结构的观点来看，所有的有限布尔代数都只不过是不同大小的幂集格的“翻版”。它们的结构完全由其原子的数量决定。
    *   **证明思路 (简述):** 构建一个从 $B$ 到 $P(A)$ 的映射 $f(x) = \{a \in A \mid a \preccurlyeq x\}$. 这个映射将 $B$ 中的每个元素 $x$ 对应到小于等于 $x$ 的所有原子的集合。可以证明这个映射是双射，并且保持 $\wedge, \vee, \neg$ 运算，从而是一个同构。
    *   **实例:** $S_{110}$ 的原子集 $A = \{2, 5, 11\}$. $P(A)$ 有 $2^3 = 8$ 个元素，正好是 $S_{110}$ 的元素个数。同构映射 $f$ 可以定义为 $f(d) = \{p \in A \mid p \text{ 整除 } d\}$.
        $f(1) = \emptyset$
        $f(2) = \{2\}$
        $f(5) = \{5\}$
        $f(11) = \{11\}$
        $f(10) = \{2, 5\}$ ($10 = 2 \times 5$, 2 整除 10, 5 整除 10)
        $f(22) = \{2, 11\}$
        $f(55) = \{5, 11\}$
        $f(110) = \{2, 5, 11\} = A$
        验证同构性质：$gcd(10, 22) = 2$. $f(gcd(10, 22)) = f(2) = \{2\}$. $f(10) \cap f(22) = \{2, 5\} \cap \{2, 11\} = \{2\}$. 运算被保持了。
        $lcm(10, 22) = 110$. $f(lcm(10, 22)) = f(110) = \{2, 5, 11\}$. $f(10) \cup f(22) = \{2, 5\} \cup \{2, 11\} = \{2, 5, 11\}$. 运算被保持了。
        补元：$10' = 110/10 = 11$. $f(10') = f(11) = \{11\}$. $f(10)'$ 在 $P(A)$ 中的补集是 $A \setminus f(10) = \{2, 5, 11\} \setminus \{2, 5\} = \{11\}$. 补元也被保持了。

*   **推论:**
    1.  任何有限布尔代数的基数（元素个数）都是 $2^n$，其中 $n$ 是其原子个数。
    2.  任何等势（元素个数相同）的有限布尔代数都是同构的。
    **结论：** 对于任何自然数 $n$，本质上只存在一个具有 $2^n$ 个元素的布尔代数（即与 $P(\{1, ..., n\})$ 同构的那个）。这意味着有限布尔代数的结构是完全由其大小决定的。

#### 一、本章的主要内容和要求（习题课部分）

这一部分是学习后的回顾和目标检测。

*   **主要内容:**
    *   格的两种定义（偏序集 vs 代数系统）及其等价性。
    *   格的基本性质：交换律、结合律、幂等律、吸收律，以及序的性质。
    *   对偶原理。
    *   子格的定义和判断。
    *   格同态和同构。
    *   特殊格：分配格（不含钻石和五角子格的判断）、有界格（0, 1 的概念）、有补格（补元概念）。
    *   布尔代数（有补分配格）及其关键性质（德摩根律，补元与序的关系）。
    *   有限布尔代数的结构（原子，表示定理）。

*   **要求:**
    *   能根据定义判别偏序集或代数系统是否构成格。
    *   能写出对偶命题。
    *   能基于定义和已知性质证明格中的等式或不等式（例如练习 1）。
    *   能判别子集是否为子格（看封闭性）。
    *   了解格同态保序性质。
    *   能判别分配格（找反例子格或用判别定理）。
    *   能识别有界格和有补格，会找补元（注意唯一性问题）。
    *   能判别布尔代数，并证明布尔代数中的等式（例如德摩根律的推导）。

#### 二、练习解析

*   **练习 1:**
    (1) 证明 $(a \wedge b) \vee b = b$. 这就是吸收律 $x \vee (x \wedge y) = x$ 的形式，令 $x=b, y=a$. 证明见前面定理 11.1 的证明。
    (2) 证明 $(a \wedge b) \vee (c \wedge d) \preccurlyeq (a \vee c) \wedge (b \vee d)$. 证明思路见前面定理 11.3 (单调性) 的应用例子。

*   **练习 2:** 求图 12 中的格 L 的所有子格。这需要逐个检查非空子集是否对 $\wedge, \vee$ 运算封闭。图 12 是一个五角格 $L_4$ (a=0, e=1, b, c, d 是中间元素)。元素是 {a, b, c, d, e}.
    *   1元子集: {a}, {b}, {c}, {d}, {e}. (单个元素集合总是封闭的)
    *   2元子集: 需要检查 $\{x, y\}$ 是否封闭，即 $x \wedge y$ 和 $x \vee y$ 是否仍在集合中。例如 {a, b}: $a \wedge b = a \in \{a, b\}$, $a \vee b = b \in \{a, b\}$. 所以 {a, b} 是子格。对于链状的子集 $\{x, y\}$ ($x \preccurlyeq y$) 总是子格，因为 $x \wedge y = x$, $x \vee y = y$. 链状子集有 {a, b}, {a, c}, {a, d}, {a, e}, {b, e}, {c, e}, {d, e}. 其他两元素集合如 {b, c}: $b \wedge c = a$, $b \vee c = e$. a 和 e 都不在 {b, c} 中，不是子格。 {b, d}: $b \wedge d = a$, $b \vee d = e$. 不是子格。 {c, d}: $c \wedge d = a$, $c \vee d = e$. 不是子格。
    *   3元子集: 需要检查所有对的 $\wedge, \vee$ 结果是否在集合中。例如 {a, b, e}: $a \wedge b = a \in$, $a \vee b = b \in$. $a \wedge e = a \in$, $a \vee e = e \in$. $b \wedge e = b \in$, $b \vee e = e \in$. {a, b, e} 是子格。 {a, c, e}, {a, d, e} 也是子格。 {b, c, d}: $b \wedge c = a$, $b \vee c = e$. a, e 都不在，不是子格。 {a, b, c}: $a \wedge b = a, a \vee b = b, a \wedge c = a, a \vee c = c, b \wedge c = a, b \vee c = e$. e不在，不是子格。同理 {a, b, d}, {a, c, d}, {b, c, e}, {b, d, e}, {c, d, e} 都需要检查。
    *   4元子集: {a, b, c, e}: $b \wedge c = a \in$. $b \vee c = e \in$. 其他组合呢？ {b, d, e}: $b \wedge d = a$, 不在。不是子格。 {a, b, d, e}: $b \wedge d = a \in$. $b \vee d = e \in$. 这个集合包含 a, b, d, e. b 和 d 的交是 a，并是 e。a 和 b 的交是 a，并是 b。a 和 d 的交是 a，并是 d。a 和 e 的交是 a，并是 e。b 和 e 的交是 b，并是 e。d 和 e 的交是 d，并是 e。看起来 {a, b, d, e} 是子格。 {a, c, d, e} 呢？ c 和 d 的交是 a，并在 e。 {a, c, d, e} 是子格。 {a, b, c, d} $b \wedge c = a \in$. $b \vee c = e$, 不在。 {b, c, d, e} $b \wedge c = a$, 不在。
    *   5元子集: {a, b, c, d, e}. 整个格 L 自身总是子格。

    这是一个细致的检查过程，根据定义一步步来。

*   **练习 3:** 判别图 13 中的格是否为分配格。图 13 中 L1 是钻石格的变体，L2 和 L3 是五角格的变体。根据定理 11.6，只要它们包含与钻石格或五角格同构的子格，就不是分配格。
    *   L1: 元素 {a, b, c, d, e}. a 是底，e 是顶。b, c, d 在中间。b, c, d 之间两两交是 a，两两并是 e。这正是钻石格的结构。所以 L1 不是分配格。
    *   L2: 元素 {a, b, c, e, f}. a 是底，f 是顶。a $\preccurlyeq$ b $\preccurlyeq$ e $\preccurlyeq$ f, a $\preccurlyeq$ c $\preccurlyeq$ e $\preccurlyeq$ f. e $\preccurlyeq$ f. b $\wedge$ c = a, b $\vee$ c = e. 如果看子集 {a, b, c, e, f} 本身，它就是 L2。其中 {a, b, c, e, f} 包含 {a, b, e, f} (链) 和 {a, c, e, f} (链)。看 {a, b, c, e, f} 这个结构，它像两个链交汇在 e 和 a。这个结构是五角格吗？五角格有 5 个点，一个点跳过一层。 L2 有 5 个点。a 就像五角格的 a，f 就像五角格的 e。b 像五角格的 b，c 像五角格的 c。e 像五角格的 d。让我们看看 L2 的结构。a $\preccurlyeq$ b, a $\preccurlyeq$ c. b $\preccurlyeq$ e, c $\preccurlyeq$ e. e $\preccurlyeq$ f. b $\wedge$ c = a, b $\vee$ c = e. b $\wedge$ e = b, b $\vee$ e = e. c $\wedge$ e = c, c $\vee$ e = e. 这个结构正是五角格 $L_4$ (图 5) 的形状，只不过标签不同。所以 L2 **是**五角格，因此不是分配格。
    *   L3: 元素 {a, c, b, e, f}. 看起来是 {a, b, c, e, f}. a 是底，f 是顶。a $\preccurlyeq$ c, a $\preccurlyeq$ b. c $\preccurlyeq$ e, b $\preccurlyeq$ e. c $\preccurlyeq$ f, b $\preccurlyeq$ f. e $\preccurlyeq$ f. c $\wedge$ b = a, c $\vee$ b = e. 这也是五角格结构 (a, c, b, e, f 对应五角格的 a, b, c, d, e). 所以 L3 **是**五角格，因此不是分配格。

    教材的解答说 L1 是钻石格同构，L2 和 L3 是五角格同构。这个判断是正确的（尽管图示形状上可能稍微有点差异，但结构是同构的）。

*   **练习 4:** 图 12 中的格 L (五角格) 求补元并判断是否有补格。图 12 元素 {a, b, c, d, e}。a 是全下界 0，e 是全上界 1。
    *   a 的补元 x 需要 $a \wedge x = a$ (不对，应该是 0) 且 $a \vee x = e$. $a \wedge x = a$ 只能是 $x \succcurlyeq a$. 全下界 0 的补元是全上界 1。 $0 \wedge 1 = a \wedge e = a$ (不对，五角格中 a $\wedge$ e = a), $0 \vee 1 = a \vee e = e$. 所以 0 的补元是 1 (a 的补元是 e)，1 的补元是 0 (e 的补元是 a)。
    *   元素 b 的补元 x 需要 $b \wedge x = a$ 且 $b \vee x = e$. 在图 12 中，d 满足条件：$b \wedge d = a$, $b \vee d = e$. 所以 d 是 b 的补元。b 只有一个补元 d。
    *   元素 c 的补元 x 需要 $c \wedge x = a$ 且 $c \vee x = e$. 在图 12 中，c 自身满足条件：$c \wedge c = c$ (不对), c 的补元是 d 吗？ $c \wedge d = a$, $c \vee d = e$. 是的，d 是 c 的补元。c 只有一个补元 d。
    *   元素 d 的补元 x 需要 $d \wedge x = a$ 且 $d \vee x = e$. b 满足：$d \wedge b = a$, $d \vee b = e$. c 满足：$d \wedge c = a$, $d \vee c = e$. 所以 d 有两个补元 b 和 c。
    由于元素 d 有两个补元，这个有界格是**有补格** (每个元素都有补元)，但**不是分配格** (五角格)，因此补元可以不唯一。

*   **练习 6:** 判断代数系统类型。
    (1) $S_1 = \{1, 1/2, 2, 1/3, 3, 1/4, 4\}$, $*$ 为普通乘法。乘法不封闭，如 $4 * 4 = 16 \notin S_1$. 不是代数系统。
    (2) $S_2 = \{a_1, ..., a_n\}$, $a_i \circ a_j = a_i$. 只有一个运算 $\circ$. 结合律：$(a_i \circ a_j) \circ a_k = a_i \circ a_k = a_i$. $a_i \circ (a_j \circ a_k) = a_i \circ a_j = a_i$. 结合律成立。是半群。单位元：存在 $e$ 使得 $a_i \circ e = a_i$ 且 $e \circ a_i = a_i$。$a_i \circ e = a_i$ 总是成立（因为结果就是第一个元素）。但 $e \circ a_i = a_i$ 需要 $e$ 满足 $e = a_i$ 对所有 $i$ 都成立，这只有当 $n=1$ 时才可能。题目说 $n > 1$. 所以没有单位元。不是独异点。
    (3) $S_3 = \{0, 1\}$, $*$ 为普通乘法。乘法封闭，结合律成立。单位元是 1。是独异点。0 没有乘法逆元。不是群。
    (4) $S_4 = \{1, 2, 3, 6\}$, $\circ = lcm$, $* = gcd$. 这个集合是 6 的正因子集合 $S_6$. 我们知道 $<S_n, gcd, lcm>$ 是格。对于 $n$ 是无平方因子的整数，它是布尔代数。$6 = 2 \times 3$, 无平方因子。所以它是布尔代数。验证一下：
        *   格：已证明。
        *   有界：0 是 1 (gcd 单位元), 1 是 6 (lcm 零元)。
        *   分配：对于 $S_n$ 总是成立（gcd 对 lcm 分配，lcm 对 gcd 分配）。
        *   有补：每个元素 $d$ 的补元是 $n/d$. $1' = 6/1=6$, $6'=6/6=1$. $2'=6/2=3$, $3'=6/3=2$. 所有元素都有补元。
        所以是格，也是布尔代数。
    (5) $S_5 = \{0, 1\}$, $*$ 为模 2 加法 ($\oplus$), $\circ$ 为模 2 乘法 ($\otimes$). $<\{0, 1\}, \oplus, \otimes>$ 是环吗？
        *   $<\!\{0, 1\}, \oplus\!>$: $0 \oplus 0 = 0, 0 \oplus 1 = 1, 1 \oplus 0 = 1, 1 \oplus 1 = 0$. 封闭，交换律，结合律。单位元 0。1 的逆元是 1，0 的逆元是 0。是交换群。
        *   $<\!\{0, 1\}, \otimes\!>$: $0 \otimes 0 = 0, 0 \otimes 1 = 0, 1 \otimes 0 = 0, 1 \otimes 1 = 1$. 封闭，交换律，结合律。是交换半群。单位元 1。
        *   分配律： $a \otimes (b \oplus c) = (a \otimes b) \oplus (a \otimes c)$. 验证所有 8 种组合即可，模 2 运算满足分配律。
        所以是交换含幺环。是整环吗？无零因子？ $a \otimes b = 0 \implies a=0$ 或 $b=0$. 只有 $0 \otimes x = 0$, $x \otimes 0 = 0$. $1 \otimes 1 = 1 \ne 0$. 是无零因子环。所以是整环。
        是域吗？整环中非零元素有乘法逆元？非零元素只有 1。1 的逆元是 1 ($1 \otimes 1 = 1$). 所以是域。
        同时，$<\{0, 1\}, \oplus, \otimes>$ 也是布尔代数。这是最小的非平凡布尔代数。$0$ 是全下界，$1$ 是全上界。$a \oplus b$ 对应布尔代数的对称差（异或），$a \otimes b$ 对应布尔代数的交（与）。布尔代数的并是 $a \vee b = a \oplus b \oplus (a \otimes b)$。补元是 $a \oplus 1$.
        实际上，任何布尔代数都可以看作一个满足 $x^2=x$ 的交换环（称为布尔环），反之亦然（通过适当定义格运算）。这里的模 2 加法和乘法正是对应布尔环的运算。当看作布尔代数时，$\oplus$ 对应对称差，$\otimes$ 对应交，并运算是 $a \vee b = a \oplus b \oplus (a \otimes b)$，补元是 $a \oplus 1$.

*   **练习 7:** 证明布尔代数中的性质。
    (1) $a \vee (a \wedge b) = a$. 这是格的吸收律，在布尔代数中当然成立。证明见前。
    (2) $a \preccurlyeq b \Leftrightarrow a \wedge b = a \Leftrightarrow a \vee b = b$. 这是格的序性质，在布尔代数中当然成立。证明见前。
    增加的证明 $a \preccurlyeq b \Leftrightarrow a \wedge b' = 0 \Leftrightarrow a' \vee b = 1$. 证明见前。

*   **练习 8:** 判断代数系统类型。
    (1) $S = \{1, 3, 4, 12\}$, $\circ = lcm$, $* = gcd$. 这个集合是 12 的正因子集合 $S_{12} = \{1, 2, 3, 4, 6, 12\}$. 题目给的集合是 $\{1, 3, 4, 12\}$，这是 $S_{12}$ 的一个子集。
        *   是格吗？需要检查 $\{1, 3, 4, 12\}$ 在 $lcm, gcd$ 下是否封闭。例如 $3 \circ 4 = lcm(3, 4) = 12 \in S$. $3 * 4 = gcd(3, 4) = 1 \in S$. 1 和 3 的 lcm 是 3，gcd 是 1。 1 和 4 的 lcm 是 4，gcd 是 1。1 和 12 的 lcm 是 12，gcd 是 1。3 和 12 的 lcm 是 12，gcd 是 3。4 和 12 的 lcm 是 12，gcd 是 4。所有结果都在集合中。所以是格。
        *   是布尔代数吗？首先，12 有平方因子 $4=2^2$. 按照前面的结论，$S_{12}$ 不是布尔代数。$\{1, 3, 4, 12\}$ 是 $S_{12}$ 的子集。它是有界格：1 是全下界，12 是全上界。它是分配格吗？ $S_{12}$ 是分配格 (任何 $S_n$ 都是分配格)。子格继承分配性。所以 $\{1, 3, 4, 12\}$ 是分配格。它是有补格吗？在 $\{1, 3, 4, 12\}$ 中，1 和 12 互补。3 的补元 x 需满足 $gcd(3, x)=1$ 且 $lcm(3, x)=12$. 检查集合中的元素：$gcd(3, 1)=1, lcm(3, 1)=3 \ne 12$. $gcd(3, 4)=1, lcm(3, 4)=12$. 4 是 3 的补元。$gcd(3, 12)=3 \ne 1$. 所以 3 的唯一补元是 4。4 的补元是 3。看起来每个元素都有补元。1 的补元是 12，12 的补元是 1。3 的补元是 4，4 的补元是 3。这个格 $\{1, 3, 4, 12\}$ **是布尔代数**。
        **注意:** 虽然 $S_{12}$ 本身不是布尔代数，但它的子格 $\{1, 3, 4, 12\}$ 却可以是。这是因为子集的结构可能比原集合更特殊。$\{1, 3, 4, 12\}$ 这个子格的哈斯图是什么样的？ 1 $\preccurlyeq$ 3, 1 $\preccurlyeq$ 4, 3 $\preccurlyeq$ 12, 4 $\preccurlyeq$ 12. 3 和 4 不可比。这是一个菱形结构（或者说 $P(\{a,b\})$ 结构）。 $\{1, 3, 4, 12\}$ 同构于 $P(\{x, y\})$, 1 对应 $\emptyset$, 3 对应 $\{x\}$, 4 对应 $\{y\}$, 12 对应 $\{x, y\}$. 幂集格是布尔代数。所以 $\{1, 3, 4, 12\}$ 是布尔代数。
    (2) $S = \{0, 1, 2\}$, $\circ$ 是模 3 加法, $*$ 是模 3 乘法。这是 $Z_3$. 模素数的整数环是域。域是特殊的整环，整环是特殊的交换含幺环。所以 $Z_3$ 是环，是整环，也是域。它**不是格**，因为它不是偏序集。它也不是布尔代数，因为它不是格。
    (3) $S = \{0, ..., n\}$, $n \ge 2$. $\circ = max$, $* = min$. 这是链 $\{0, 1, ..., n\}$ 关于通常小于等于关系的格。
        *   是格吗？ $\max(x, y)$ 和 $\min(x, y)$ 总是存在且唯一的，且在 $S$ 中。是格。
        *   是布尔代数吗？是链，所以是分配格。是有限集，所以有界 (0 是全下界，n 是全上界)。它是有补格吗？考虑元素 1 ($0 < 1 < n$ 如果 $n > 1$). 1 的补元 x 需满足 $\min(1, x) = 0$ 且 $\max(1, x) = n$. $\min(1, x) = 0$ 意味着 $x=0$. 但 $\max(1, 0) = 1 \ne n$ (如果 $n>1$). 所以 1 没有补元。因此，当 $n>1$ 时，它不是有补格。当 $n=1$ 时，$S=\{0,1\}$, $\min,\max$ 格是 $\{0,1\}$ 链，补元存在 ($0'=1, 1'=0$)，是布尔代数。但题目说 $n \ge 2$. 所以不是布尔代数。

#### 总结与要点提炼

本章围绕“格”这一概念展开，从偏序集的最基本属性出发，逐步增加限制条件，最终得到具有丰富结构的“布尔代数”。

*   **格 (Lattice):**
    *   **定义:** 偏序集 $(S, \preccurlyeq)$ 中，任意两元素都有唯一的最小上界 ($\vee$) 和最大下界 ($\wedge$).
    *   **等价代数定义:** 代数系统 $(S, \vee, \wedge)$ 满足交换律、结合律、吸收律。
    *   **核心性质:** 对偶原理，吸收律 $a \vee (a \wedge b) = a$, 序关系与运算的关系 $a \preccurlyeq b \Leftrightarrow a \wedge b = a \Leftrightarrow a \vee b = b$.
    *   **判别:** 哈斯图上任意两点上方都有唯一汇合点，下方都有唯一汇合点。
*   **子格:** 子集对原格运算封闭。
*   **分配格 (Distributive Lattice):**
    *   **定义:** 满足分配律 $a \wedge (b \vee c) = (a \wedge b) \vee (a \wedge c)$ (或其对偶形式)。
    *   **核心性质:** 补元若存在则唯一。
    *   **判别:** 不含与钻石格或五角格同构的子格。
*   **有界格 (Bounded Lattice):**
    *   **定义:** 存在全下界 0 和全上界 1。
    *   **核心性质:** 0 是 $\wedge$ 的零元，$\vee$ 的单位元；1 是 $\vee$ 的零元，$\wedge$ 的单位元。
    *   **判别:** 有限格总是有界。
*   **有补格 (Complemented Lattice):**
    *   **定义:** 有界格中，每个元素都有补元（与自身交为 0，并为 1 的元素）。
    *   **注意:** 补元不一定唯一。
*   **布尔代数 (Boolean Algebra):**
    *   **定义:** 有补的分配格。
    *   **核心性质:** 补元唯一（允许定义一元补元运算 $\neg$），德摩根律，序与补元的关系 $a  b \Leftrightarrow a \wedge b' = 0 \Leftrightarrow a' \vee b = 1$.
    *   **判别:** 是格，分配格，有界格，且每个元素都有补元。
    *   **有限布尔代数:** 结构完全由原子个数决定，大小为 $2^n$，同构于幂集代数。

#### 学科思想与延伸思考

*   **抽象与统一:** 格与布尔代数体现了数学抽象的力量。它们从看似不同的具体系统（集合、逻辑、数论）中提取共有的结构，并用一套统一的语言（偏序、上下界、运算律）来描述和研究。
*   **结构决定性质:** 分配律和有补性是布尔代数区别于一般格的关键性质，正是这些性质赋予了布尔代数丰富的代数结构，并使得它能够作为逻辑和集合论的代数模型。补元的唯一性正是有界分配格结构的直接推论。
*   **表示定理:** 有限布尔代数的表示定理是一个非常深刻的结果。它告诉我们，在有限的情况下，所有布尔代数本质上都是一样的，都可以“表示”为简单的集合的幂集。这大大简化了对有限布尔代数的研究。在无限情况下，也有类似的表示定理（Stone's Representation Theorem），将布尔代数同胚于一个紧致全不连通豪斯多夫空间中的闭开集代数，虽然复杂但思想一脉相承。
*   **与环和域的联系:** 布尔代数与布尔环有紧密的联系。布尔环是满足 $x^2=x$ 的环。任何布尔代数可以通过适当定义运算构成布尔环，反之亦然。这说明不同的代数结构之间并非完全独立，可能存在深刻的联系和转换。模 2 运算的 $\{0, 1\}$ 既是域又是布尔代数，这反映了它的特殊性。

希望这次详细的讲解能帮助你理清格与布尔代数的概念，理解它们“为什么”是这样定义的，以及它们之间的关系和重要性质。记住，理解推导过程远比死记公式重要。多练习，多思考，你会逐渐领略到这些抽象结构的美妙之处！