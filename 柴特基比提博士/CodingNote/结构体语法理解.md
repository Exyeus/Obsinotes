[[结构体]][[Enum枚举结构]]
### 1. `typedef` 和 `struct` 语法

#### `typedef` 语法
`typedef` 用于定义一个类型的别名，使得代码更加简洁易读。语法如下：

```c
typedef <原类型> <新类型名称>;
```

例如，定义一个 `int` 类型的别名 `Integer`：

```c
typedef int Integer;
```

然后就可以用 `Integer` 来代替 `int` 类型。

#### `struct` 语法
`struct` 用来定义结构体类型，它是一种自定义的数据类型，可以存储不同类型的数据。结构体定义的语法如下：

```c
struct <结构体名称> {
    <数据类型> <成员名称>;
    <数据类型> <成员名称>;
    ...
};
```

例如，定义一个表示点的结构体：

```c
struct Point {
    int x;
    int y;
};
```

#### 使用 `typedef` 和 `struct` 结合
常常将 `typedef` 和 `struct` 结合使用，以简化结构体类型的使用：

```c
typedef struct Point {
    int x;
    int y;
} Point;
```

这样，你可以直接使用 `Point` 代替 `struct Point` 来声明结构体变量。

### 2. 结构体类型的指针

结构体类型的指针是指向结构体类型的指针变量。可以使用结构体指针来访问结构体的成员。结构体指针和结构体变量的区别在于，结构体指针存储的是结构体的地址，而结构体变量存储的是结构体的值。

定义结构体类型指针：

```c
struct Point {
    int x;
    int y;
};

struct Point* ptr;  // 指向结构体 Point 的指针
```

通过结构体指针访问成员时，使用 `->` 操作符：

```c
ptr = malloc(sizeof(struct Point));  // 动态分配内存
ptr->x = 10;  // 通过指针访问成员
ptr->y = 20;
```

这时 `ptr` 指向一个 `struct Point` 类型的对象，`ptr->x` 和 `ptr->y` 就是指向该对象的成员。

### 3. 用指针调用结构体的硬件基础

从硬件的角度来看，结构体是一组按照定义顺序排列在内存中的数据项。当使用指针调用结构体成员时，实际上是通过指针访问结构体内存块中的特定偏移位置。

#### 内存布局
假设有以下结构体定义：

```c
struct Point {
    int x;
    int y;
};
```

在内存中，`struct Point` 会按照顺序将 `x` 和 `y` 存储在内存中（注意，实际布局可能会有内存对齐的影响，具体取决于系统架构）。例如，在一个 `x86` 架构中，内存布局可能如下：

| 地址   | 内容   |
|--------|--------|
| 0x00   | `x`    |
| 0x04   | `y`    |

#### 通过指针访问
假设 `ptr` 是指向 `struct Point` 类型的指针：

```c
struct Point* ptr;
ptr = malloc(sizeof(struct Point));
```

- `ptr` 存储的是结构体 `Point` 对象的内存地址。
- `ptr->x` 实际上是对 `ptr` 指向的内存地址加上 `x` 的偏移量（通常是 `0`，因为 `x` 是结构体的第一个成员）。
- `ptr->y` 则是对 `ptr` 指向的内存地址加上 `y` 的偏移量。

硬件层面上，指针是内存地址的表示，操作指针时，CPU 会直接访问内存中的特定位置，获取或修改数据。

#### 指针操作的底层实现
当你使用指针调用结构体成员时，操作符 `->` 会被转换为以下形式：

```c
ptr->x  // 等价于 *(ptr).x
```

这意味着 `ptr->x` 实际上是通过解引用 `ptr`（即 `*ptr`）来访问其成员 `x`。编译器会根据结构体成员的偏移量生成相应的汇编指令，以从内存中加载或存储数据。

总结来说：
- `typedef` 可以简化类型的使用，`struct` 用来定义包含多个成员的数据类型。
- 结构体指针允许通过内存地址来访问结构体的成员，使用 `->` 来操作。
- 在硬件层面，指针操作通过内存地址偏移来访问结构体的成员，每个成员有特定的内存位置。
如果仅使用 `struct` 语法来定义结构体类型，而不结合 `typedef`，则定义结构体时必须使用 `struct` 关键字来声明类型，每次使用该结构体类型时都需要加上 `struct` 关键字。

### 1. `struct` 语法

在没有使用 `typedef` 的情况下，定义结构体类型的语法如下：

```c
struct StructName {
    <data_type> member1;
    <data_type> member2;
    // 更多成员...
};
```

其中：
- `struct` 是关键字，表示结构体。
- `StructName` 是结构体类型的名称。
- 每个成员（`member1`, `member2` 等）有其数据类型和名称。

### 示例

```c
struct Point {
    int x;
    int y;
};
```

这里定义了一个名为 `Point` 的结构体类型，包含两个成员：
- `x`：类型为 `int`。
- `y`：类型为 `int`。

### 2. 使用 `struct` 定义变量

定义结构体类型后，可以用 `struct` 关键字来声明变量：

```c
struct Point p1, p2;
```

这声明了两个 `Point` 类型的结构体变量 `p1` 和 `p2`。

#### 访问结构体成员

可以通过 `.` 操作符来访问结构体的成员：

```c
p1.x = 10;
p1.y = 20;
```

这里，`p1.x` 和 `p1.y` 用来访问 `p1` 结构体中的 `x` 和 `y` 成员。

### 3. 结构体指针的使用

如果你定义了一个结构体类型，可以创建结构体类型的指针，并通过指针访问结构体的成员。指针访问结构体成员时，使用 `->` 操作符。

例如：

```c
struct Point {
    int x;
    int y;
};

struct Point *ptr;
ptr = &p1;  // ptr 指向 p1

ptr->x = 30;  // 通过指针访问成员
ptr->y = 40;
```

这里，`ptr` 是一个指向 `struct Point` 类型的指针。通过 `ptr->x` 和 `ptr->y` 来访问结构体成员。

### 4. 总结

- 如果使用 `struct` 语法定义结构体，不使用 `typedef`，每次声明结构体类型的变量时，都需要加上 `struct` 关键字。
- 使用 `struct` 可以定义包含不同类型成员的数据结构，但每次引用时需要加上 `struct` 前缀。
