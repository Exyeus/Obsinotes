---
sr-due: 2025-04-14
sr-interval: 4
sr-ease: 270
---

#review 

Scheme 是一种 "call-by-value" 语言，即所谓的传值调用。Scheme 的核心语法很小，扩展语法是在核心语法的基础上派生而来，核心语法加上扩展语法再加上一组元过程（比如`+ - * /`)构成了完整的 Scheme 语言。

Scheme 代码和数据共享一个*相同的打印表示法*，这样做的结果是，任何 Scheme 代码都可以自然而然地表示为一个 Scheme 对象。例如，变量及语法关键字可以表示为符号，结构化的语法形式可以表示为列表。这种表示法是 Scheme 提供的语法扩展工具（宏）的基础，通过宏，可以在现有的语法形式及过程的基础上定义出新的语法。它还促进了直接用 Scheme 来实现 Scheme 的解释器，编译器及其它代码转换工具，以及用 Scheme 来实现其它语言转换工具。

## 1.1 Scheme语法

关键字，变量，结构形式，常量数据（数字，字符，字符串，被引用的向量，被引用的列表，被引用的符号），空白符，以及注释组成。

关键字，变量，符号统称标识符。标识符不能以符号(@)开头，并且通常也不能以数字，正号(+)，负号(-) 及小数点开头，以免被识别为数字。是大小写敏感的。

配对的方括号( \[\] )可以代替括号使用，并且常用于点缀某些标准句法形式的子表达式，以增加代码的可读性，如本书中的示例所示。

*向量*类似于列表，除了前面有一个前缀`#`，例如`#(this is a vector of symbols)`。Bytevectors(字节向量) 表示为无符号字节值（0 ~ 255 之间的精确整数）的序列，以`#vu8`为前缀，例如：`#vu8(3 250 45 73)`.

字符串是由双引号引起来的字符序列，例如 "I am a string".

字符由前缀 `#\`加上字符本身表示，例如 `#\a`, 和标识符一样，字符和字符串也是大小写敏感的。

数字可以写作整数形式，例如 -123; 有理数形式，例如 1/2；浮点数或者科学计数法形式，例如 1.3 或者 1e23；以及复数形式，如 1.3-2.7i 或者 -1.2@73 。在数字的语法中，大小写是不敏感的。

表示真和假的布尔值分别写作 `#t` 和 `#f`。在 Scheme 条件表达式中，只有 `#f` 代表 假，其它的所有对象都被视为 真。所以，3, 0, (), "false"，`nil` 都被视为真。

Scheme 注释以分号(;)开头，一直延伸到行尾，注释可以出现在任意一行。对某一行的注释通常放在该行的前面一行，并且采用相同的缩进级别。对某个函数的注释通常放在该函数前面，不缩进。
## 1.2 Scheme命名约定

- 谓词的名字以问号结尾，谓词就是那些返回布尔值的函数，比如`eq?`,`zero?`以及`string=?`。通常的数值比较过程`=, <, >, <=, >=`不遵守这个惯例。
    
- 类型谓词就是类型的名字加上问号，比如 `pair?`，`number?`。
    
- 大多数与字符，字符串及向量有关的过程以前缀`char-`, `string-`以及`vector-`开头。比如`string-append`,(一些与列表操作有关的过程也是以`list-`开头，但是大部分不是这样)
    
- 将一个类型的对象转换为另一个类型的对象的过程，写为_type1->type2_，比如`vector->list`。
    
- 具有“副作用”的过程及宏的名字后边要跟上感叹号（!）。例如，`set!`以有`vector-set!`。执行输入或输出的过程也有副作用，但是它们的命名不遵守这个规则。

## 1.3 排版及符号约定

### 1. 关于返回值未指定的情况

- **返回值未指定的定义**：如果一个标准过程或语法形式的唯一目的是产生某种副作用，那么就说它返回未指定的值。这意味着实现可以自由地返回任意数量的值，每个值都可以是任意的 Scheme 对象，作为该过程或语法形式的返回值。
- **返回值的不确定性**：不要指望这些返回值在不同实现之间、同一实现的不同版本之间、甚至同一过程或语法形式的两次使用之间是相同的。有些 Scheme 系统通常会使用一个特殊对象来表示未指定的值。交互式 Scheme 系统通常会抑制这个对象的打印，因此不会打印返回未指定值的表达式的值。

### 2. 关于过程返回多个值的情况

- **语言支持**：虽然大多数标准过程返回单个值，但该语言支持通过第 5.8 节中描述的机制返回零个、一个、多个甚至可变数量值的过程。
- **表达式返回多个值的情况**：如果某个标准表达式的一个子表达式返回多个值（例如，通过调用一个返回多个值的过程），那么该表达式可以说返回“这些值”，而不仅仅是子表达式的“值”。同样，一个返回过程参数调用结果的标准过程，可以说返回过程参数返回的值。

### 3. 关于程序要求的描述方式

- **“必须”和“应该”的使用**：本书使用“必须”和“应该”来描述程序要求，例如在调用 vector-ref 时提供一个小于向量长度的索引的要求。如果使用“必须”，意味着该要求由实现强制执行，即通常会抛出条件类型为 &assertion 的异常。如果使用“应该”，可能会也可能不会抛出异常，如果没有抛出异常，程序的行为是未定义的。

### 4. 关于语法违规的处理

- **语法违规的定义**：“语法违规”一词用于描述程序格式错误的情况。语法违规会在程序执行之前被检测到。当检测到语法违规时，会抛出类型为 &syntax 的异常，程序不会被执行。

### 5. 关于排版规范

- **Scheme 对象的排版**：本书使用的排版约定是直接的。所有 Scheme 对象都以打字机字体打印，就像它们在键盘上输入的一样。这包括语法关键字、变量、常量对象、Scheme 表达式和示例程序。在描述语法形式的语法变量和过程的参数描述中，使用斜体字体来突出显示。斜体也用于首次出现的技术术语。一般来说，语法形式和过程的名称永远不会大写，即使在句子的开头。斜体书写的语法变量也是如此。
- **原型模式的使用**：在描述语法形式或过程时，一个或多个原型模式显示语法形式或过程的正确数量的参数。关键字或过程名称以打字机字体给出，括号也是如此。其余的语法或参数以斜体显示，使用一个暗示语法形式或过程期望的表达式或参数类型的名称。使用省略号来指定零个或多个子表达式或参数的发生。例如，(or expr ...) 描述了 or 语法形式，它有零个或多个子表达式，而 (member obj list) 描述了 member 过程，它期望两个参数，一个对象和一个列表。
- **语法形式结构与原型不匹配的情况**：如果语法形式的结构与其原型不匹配，则会发生语法违规。同样，如果传递给标准过程的参数数量与其指定的接收数量不匹配，或者标准过程接收到的参数类型与其名称暗示的类型不符或不满足过程描述中给出的其他标准，则会抛出条件类型为 &assertion 的异常。例如，vector-set! 的原型是 (vector-set! vector n obj)，描述中说明 n 必须是严格小于向量长度的精确非负整数。因此，vector-set! 必须接收三个参数，第一个必须是向量，第二个必须是小于向量长度的精确非负整数，第三个可以是任意 Scheme 值。否则，会抛出条件类型为 &assertion 的异常。
- **参数类型要求的表示方式**：在大多数情况下，所需的参数类型是显而易见的，如向量、对象或二进制输入端口。在其他情况下，主要是在数值例程的描述中，使用缩写，如 int 表示整数，exint 表示精确整数，fx 表示固定数。这些缩写在包含受影响条目的章节开头进行了说明。

这段内容为读者提供了 Scheme 编程语言在排版、语法、异常处理等方面的具体约定和规范，有助于读者更好地理解和使用 Scheme 语言。




































